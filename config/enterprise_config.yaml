# CYBERGUARD ENTERPRISE CONFIGURATION

# This is the main configuration file for the CyberGuard Web Security AI System.
# It defines global settings, system parameters, and deployment configurations.
# All values can be overridden by environment variables with prefix "CG_"
# Example: CG_SYSTEM_ENVIRONMENT=staging

# SYSTEM IDENTITY & METADATA
system:
  # Unique identifier for this CyberGuard deployment
  # Used for logging, monitoring, and multi-instance coordination
  deployment_id: "cyberguard-prod-001"
  
  # Human-readable system name for UI and reports
  name: "CyberGuard Web Security AI System"
  
  # Version following semantic versioning (MAJOR.MINOR.PATCH)
  # MAJOR: Breaking changes, MINOR: New features, PATCH: Bug fixes
  version: "1.0.0"
  
  # Deployment environment: development, staging, production
  # Affects logging level, caching, and security strictness
  environment: "production"
  
  # Organization name for compliance reporting
  organization: "SecureCorp Inc."
  
  # Contact email for security incidents and alerts
  # This email receives critical security notifications
  security_contact: "security@securecorp.com"
  
  # License information for compliance and audit
  license: "Enterprise Security License v2.0"
  
  # Data retention policy (in days)
  # How long to keep logs, scan results, and threat data
  # GDPR requires justification for >30 days
  data_retention_days: 365

# SECURITY & COMPLIANCE SETTINGS
security:
  # Zero-trust architecture settings
  # Zero-trust assumes no implicit trust, verifies every request
  zero_trust:
    # Enable mutual TLS for all internal communications
    # Both client and server authenticate each other
    enable_mtls: true
    
    # Require authentication for all API endpoints
    # No anonymous access to any endpoint
    require_auth_for_all_endpoints: true
    
    # Default deny policy (whitelist approach)
    # Only explicitly allowed traffic is permitted
    default_deny: true
  
  # Encryption settings for data protection
  encryption:
    # Default encryption algorithm for data at rest
    # AES-256-GCM provides both confidentiality and integrity
    algorithm: "AES-256-GCM"
    
    # Key rotation interval in days
    # Regular rotation limits damage from key compromise
    key_rotation_days: 30
    
    # Enable hardware security module (HSM) integration
    # HSM provides physical security for cryptographic keys
    enable_hsm: false
    
    # HSM provider (if enabled): aws_kms, azure_keyvault, gcp_kms, hashicorp_vault
    # Cloud HSMs provide managed key security
    hsm_provider: "hashicorp_vault"
  
  # Compliance frameworks to enforce
  # System validates against these standards automatically
  compliance:
    - "GDPR"           # General Data Protection Regulation (EU privacy law)
    - "HIPAA"          # Health Insurance Portability and Accountability Act (US healthcare)
    - "PCI-DSS"        # Payment Card Industry Data Security Standard (credit card security)
    - "SOC2"           # Service Organization Control 2 (service provider security)
    - "ISO-27001"      # Information Security Management Standard (international)
    - "NIST-CSF"       # National Institute of Standards and Technology Cybersecurity Framework
  
  # Privacy settings for data handling
  privacy:
    # Enable data anonymization for logs and analytics
    # Replaces identifiable data with pseudonyms
    anonymize_sensitive_data: true
    
    # Data minimization: only collect necessary data
    # GDPR principle - collect only what's needed
    data_minimization: true
    
    # User consent requirement for data processing
    # Explicit opt-in required for data collection
    require_user_consent: true
    
    # Right to be forgotten (GDPR compliance)
    # Allows users to request deletion of their data
    enable_right_to_be_forgotten: True

# WEB SECURITY SCANNING CONFIGURATION
web_security:
  # Scanning depth and intensity controls
  scanning:
    # Maximum depth to follow links (prevents infinite crawling)
    # Depth 0 = only main page, 1 = main page + links, etc.
    max_scan_depth: 3
    
    # Maximum pages to scan per website
    # Prevents scanning very large sites completely
    max_pages_per_scan: 100
    
    # Timeout for individual HTTP requests (seconds)
    # Aborts slow connections to prevent hanging
    request_timeout: 10
    
    # Timeout for entire scan (minutes)
    # Maximum time allowed for complete website scan
    scan_timeout: 30
    
    # Rate limiting: requests per second
    # Avoids overwhelming target servers
    requests_per_second: 5
    
    # Respect robots.txt directives
    # Honors website's crawling preferences
    respect_robots_txt: true
    
    # User agent string for scanning
    # Identifies scanner to web servers
    user_agent: "CyberGuard-Security-Scanner/1.0 (+https://cyberguard.example.com)"
  
  # Vulnerability detection settings
  vulnerabilities:
    # OWASP Top-10 categories to scan for
    # OWASP = Open Web Application Security Project
    owasp_top_10:
      A01: "Broken Access Control"
      A02: "Cryptographic Failures"
      A03: "Injection"
      A04: "Insecure Design"
      A05: "Security Misconfiguration"
      A06: "Vulnerable and Outdated Components"
      A07: "Identification and Authentication Failures"
      A08: "Software and Data Integrity Failures"
      A09: "Security Logging and Monitoring Failures"
      A10: "Server-Side Request Forgery"
    
    # Enable specific vulnerability detection modules
    # Each module implements detection for specific attack type
    enable_detection:
      xss: true           # Cross-Site Scripting - malicious scripts in web pages
      sqli: true          # SQL Injection - database manipulation through inputs
      csrf: true          # Cross-Site Request Forgery - unauthorized actions
      ssrf: true          # Server-Side Request Forgery - server makes requests to internal resources
      rce: true           # Remote Code Execution - execute arbitrary code
      lfi: true           # Local File Inclusion - include local files
      rfi: true           # Remote File Inclusion - include remote files
      xxe: true           # XML External Entity - XML parser vulnerability
      idor: true          # Insecure Direct Object Reference - direct access to objects
      path_traversal: true # Directory Traversal - access files outside web root
      command_injection: true # OS command execution through application
      deserialization: true # Unsafe deserialization of objects
    
    # Severity thresholds for reporting using CVSS scores
    # CVSS = Common Vulnerability Scoring System (0-10 scale)
    severity_thresholds:
      critical: 9.0    # CVSS score >= 9.0 - immediate action required
      high: 7.0        # CVSS score >= 7.0 - address quickly
      medium: 4.0      # CVSS score >= 4.0 - schedule for fix
      low: 0.1         # CVSS score >= 0.1 - low priority
      info: 0.0        # Informational findings - no direct threat
  
  # API security scanning configuration
  api_security:
    # Enable API endpoint discovery
    # Automatically finds API endpoints through crawling
    enable_api_discovery: true
    
    # Automatically test discovered APIs
    # Runs security tests on found API endpoints
    auto_test_discovered_apis: true
    
    # Common API security tests based on OWASP API Top-10
    api_tests:
      - "broken_object_level_authorization"  # BOLA - access others' data
      - "broken_user_authentication"         # Authentication flaws
      - "excessive_data_exposure"            # Returns more data than needed
      - "lack_of_resources_rate_limiting"    # No rate limiting
      - "broken_function_level_authorization" # BFLA - access unauthorized functions
      - "mass_assignment"                    # Set object properties not intended
      - "security_misconfiguration"          # Wrong security settings
      - "injection"                          # SQL/NoSQL/command injection
    
    # Rate limiting tests configuration
    rate_limiting:
      # Test for rate limiting vulnerabilities
      # Attempts to bypass or overwhelm rate limits
      test_rate_limiting: true
      
      # Number of requests to test with
      # How many requests to send during testing
      test_requests: 100
      
      # Time window for rate limiting test (seconds)
      # Time period over which to send test requests
      time_window: 60

# AI MODEL & INFERENCE CONFIGURATION
ai:
  # GQA (Grouped Query Attention) Transformer settings
  # GQA balances performance and memory by grouping key-value heads
  gqa_transformer:
    # Model architecture parameters
    d_model: 512               # Dimension of model embeddings (hidden size)
    n_layers: 6                # Number of transformer layers (depth)
    n_heads: 8                 # Number of attention heads (parallel attention)
    n_groups: 2                # Number of KV head groups (GQA innovation)
    d_ff: 2048                 # Feed-forward network dimension (usually 4Ã—d_model)
    dropout: 0.1               # Dropout rate for regularization (prevents overfitting)
    activation: "gelu"         # Activation function (Gaussian Error Linear Unit)
    
    # Sequence processing limits
    max_sequence_length: 2048  # Maximum tokens per sequence (context window)
    vocab_size: 50257          # Vocabulary size (compatible with GPT-2)
    
    # Positional encoding type
    # RoPE (Rotary Positional Embedding) handles long sequences better
    positional_encoding: "rope" # Options: rope (rotary), sinusoidal (original)
    
    # Attention optimization settings
    use_flash_attention: true  # Use Flash Attention for 2-3x speedup
    use_mixed_precision: true  # Use mixed precision (FP16) for training (memory saving)
    
    # KV cache optimization for inference
    enable_kv_cache: true      # Cache key-value pairs for faster inference
    kv_cache_max_tokens: 8192  # Maximum tokens to cache (memory vs speed tradeoff)
  
  # Threat classification model configuration
  threat_classifier:
    # Number of threat categories to classify
    # Each category represents a type of security threat
    num_classes: 50
    
    # Confidence thresholds for classification decisions
    # Determines when to trust model predictions
    confidence_thresholds:
      certain: 0.9     # >90% confidence - high trust, automatic action
      high: 0.7        # >70% confidence - medium trust, may require review
      medium: 0.5      # >50% confidence - low trust, always review
      low: 0.3         # >30% confidence - very low trust, informational only
    
    # Enable explainable AI (XAI) for model decisions
    # Provides human-understandable explanations for predictions
    enable_explainability: true
    
    # XAI methods to use for explaining model decisions
    xai_methods:
      - "attention_visualization"     # Shows what the model attends to
      - "feature_importance"          # Shows which features mattered most
      - "counterfactual_explanation"  # Shows what would change the prediction
      - "lime"                        # Local Interpretable Model-agnostic Explanations
      - "shap"                        # SHapley Additive exPlanations
  
  # Inference settings for model predictions
  inference:
    # Batch size for parallel inference
    # Larger batches = faster but more memory
    batch_size: 32
    
    # Maximum tokens to generate for text outputs
    # Limits response length
    max_new_tokens: 512
    
    # Sampling temperature (0.0 = deterministic, 1.0 = creative)
    # Controls randomness in generation
    temperature: 0.7
    
    # Top-p (nucleus) sampling - keeps top p% of probability mass
    # Filters unlikely tokens while maintaining diversity
    top_p: 0.95
    
    # Top-k sampling - keeps only top k tokens
    # Limits choices to most probable tokens
    top_k: 50
    
    # Repetition penalty - discourages repeating same content
    # Higher values = less repetition
    repetition_penalty: 1.2
    
    # Length penalty - encourages/discourages longer outputs
    # >1 = encourages longer, <1 = encourages shorter
    length_penalty: 1.0

# MULTI-AGENT SYSTEM CONFIGURATION
agents:
  # General agent settings applying to all agents
  general:
    # Maximum number of concurrent agents
    # Limits parallel processing to prevent resource exhaustion
    max_concurrent_agents: 10
    
    # Agent timeout in seconds
    # Kills agents taking too long to prevent hangs
    agent_timeout_seconds: 300
    
    # Memory size per agent (in tokens/entries)
    # How much history/context each agent remembers
    agent_memory_size: 1000
    
    # Communication buffer size for inter-agent messages
    # Queue size for agent communication
    communication_buffer_size: 1000
    
    # Enable agent persistence (save/load state)
    # Allows agents to resume after restart
    enable_persistence: true
    
    # Persistence interval in minutes
    # How often to save agent state
    persistence_interval_minutes: 5
  
  # Individual agent configurations
  # Each agent specializes in different security aspects
  
  web_threat_detection:
    # Confidence weight in ensemble voting
    # Higher weight = more influence on final decision
    weight: 1.0
    
    # Enable/disable this agent
    # Can disable malfunctioning or unnecessary agents
    enabled: true
    
    # Specialized threat detection capabilities
    specializations:
      - "xss_detection"         # Cross-Site Scripting
      - "sqli_detection"        # SQL Injection
      - "csrf_detection"        # Cross-Site Request Forgery
      - "ssrf_detection"        # Server-Side Request Forgery
      - "command_injection"     # OS Command Injection
    
    # Detection confidence thresholds
    thresholds:
      xss_confidence: 0.7    # 70% confidence required for XSS detection
      sqli_confidence: 0.8   # 80% confidence required for SQLi detection
      csrf_confidence: 0.6   # 60% confidence required for CSRF detection
  
  # Traffic anomaly detection agent
  # Detects unusual patterns in network traffic
  traffic_anomaly:
    weight: 0.9
    enabled: true
    window_size: 100          # Number of requests to analyze together
    anomaly_threshold: 3.0    # Z-score threshold for anomaly detection
    enable_autoencoder: true  # Use neural network for anomaly detection
  
  # Bot detection agent
  # Identifies automated/bot traffic vs human traffic
  bot_detection:
    weight: 0.8
    enabled: true
    rate_limit_threshold: 100      # Requests per minute threshold
    enable_behavioral_analysis: true  # Analyze mouse movements, typing patterns
    bot_signatures_file: "config/bot_signatures.json"  # Known bot patterns
  
  # Malware payload analysis agent
  # Analyzes files and payloads for malicious content
  malware_payload:
    weight: 0.85
    enabled: true
    yara_rules_file: "config/yara_rules.yar"  # YARA malware detection rules
    enable_heuristic_analysis: true          # Pattern-based detection
    enable_sandboxing: false  # Requires Docker isolation for safe execution
  
  # Exploit chain reasoning agent
  # Connects individual vulnerabilities into attack chains
  exploit_chain_reasoning:
    weight: 0.95
    enabled: true
    max_chain_length: 5          # Maximum steps in attack chain
    enable_attack_graph: true    # Visualize attack paths
  
  # Digital forensics agent
  # Collects and analyzes evidence from security incidents
  digital_forensics:
    weight: 0.7
    enabled: true
    evidence_retention_days: 90  # How long to keep forensic evidence
    enable_timeline_analysis: true  # Create timeline of events
  
  # Incident response agent
  # Automates response to security incidents
  incident_response:
    weight: 1.0
    enabled: true
    auto_response_enabled: true   # Enable automated responses
    escalation_threshold: 0.8     # Threat level requiring human escalation
    response_playbooks:           # Pre-defined response procedures
      - "data_breach"            # Response to data breach
      - "ransomware"             # Response to ransomware attack
      - "ddos"                   # Response to DDoS attack
      - "insider_threat"         # Response to insider threat
  
  # Compliance and privacy agent
  # Ensures regulatory compliance
  compliance_privacy:
    weight: 0.6
    enabled: true
    compliance_frameworks:        # Regulations to enforce
      - "GDPR"                   # General Data Protection Regulation
      - "HIPAA"                  # Health Insurance Portability Act
      - "PCI-DSS"                # Payment Card Industry Standard
      - "CCPA"                   # California Consumer Privacy Act
    privacy_check_interval: 3600  # How often to check compliance (seconds)
  
  # Secure code review agent
  # Analyzes source code for security vulnerabilities
  secure_code_review:
    weight: 0.75
    enabled: true
    languages:                    # Programming languages supported
      - "python"
      - "javascript"
      - "java"
      - "php"
      - "go"
    security_rules: "config/security_rules.yaml"  # Code security rules
  
  # Threat education agent
  # Provides security training and guidance
  threat_education:
    weight: 0.5
    enabled: true
    enable_interactive_learning: true  # Interactive tutorials
    learning_modules:                  # Available training modules
      - "owasp_top_10"                # OWASP Top-10 vulnerabilities
      - "secure_coding"               # Secure coding practices
      - "incident_response"           # How to respond to incidents
      - "threat_hunting"              # Proactive threat detection

# MHC (MANIFOLD-CONSTRAINED HYPER-CONNECTIONS) CONFIGURATION
# MHC stabilizes multi-agent coordination using mathematical constraints
mhc:
  # Core MHC parameters for stable agent coordination
  core:
    # State dimension for manifold representation
    # Higher dimensions = more expressive but slower
    state_dimension: 512
    
    # Temperature for attention smoothing
    # Higher = more uniform attention, lower = more focused
    temperature: 1.0
    
    # Number of Sinkhorn iterations for doubly-stochastic normalization
    # Ensures fair distribution of attention across agents
    sinkhorn_iterations: 50
    
    # Small epsilon for numerical stability
    # Prevents division by zero
    epsilon: 1e-8
    
    # Signal bound to prevent explosion
    # Limits maximum magnitude of signals between agents
    signal_bound: 1.0
    
    # Identity preservation factor
    # How much of original signal to preserve vs mix
    identity_preserve_factor: 0.1
  
  # Coordination strategies for multi-agent interaction
  coordination:
    # Strategy for agent coordination
    strategy: "residual_coordination"  # Options: residual, attention, ensemble
    
    # Enable convex state mixing
    # Combines agent states in stable, bounded way
    enable_convex_mixing: true
    
    # Enable doubly-stochastic normalization
    # Ensures each agent gives and receives equal attention
    enable_doubly_stochastic: true
    
    # Enable non-expansive updates
    # Prevents signals from growing unbounded
    enable_non_expansive_updates: true
    
    # Enable identity-preserving mappings
    # Agents retain some individuality during coordination
    enable_identity_preservation: true
  
  # Stability enforcement to prevent coordination failures
  stability:
    # Maximum allowed signal growth per step
    # Limits how quickly signals can amplify
    max_signal_growth: 1.1
    
    # Minimum agent contribution (prevents starvation)
    # Ensures all agents contribute meaningfully
    min_agent_contribution: 0.05
    
    # Maximum agent dominance (prevents takeover)
    # Prevents single agent from dominating decisions
    max_agent_dominance: 0.7
    
    # Enable gradient clipping for training stability
    # Prevents exploding gradients during training
    enable_gradient_clipping: true
    
    # Gradient clipping norm
    # Maximum allowed gradient magnitude
    gradient_clip_norm: 1.0
  
  # Performance optimization for MHC operations
  performance:
    # Enable caching for Sinkhorn iterations
    # Speeds up repeated computations
    enable_caching: true
    
    # Cache size for manifold states
    # How many states to cache
    cache_size: 1000
    
    # Enable parallel processing
    # Process multiple agents simultaneously
    enable_parallel_processing: true
    
    # Number of parallel workers
    # More workers = faster but more memory
    num_workers: 4

# DATA INGESTION & THREAT INTELLIGENCE
data:
  # Threat intelligence feeds - external sources of threat data
  threat_intelligence:
    # CVE (Common Vulnerabilities and Exposures) feeds
    # Standardized identifiers for vulnerabilities
    cve_feeds:
      - "https://cve.mitre.org/data/downloads/allitems.csv"
      - "https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-%Y.json.gz"
      - "https://services.nvd.nist.gov/rest/json/cves/2.0"
    
    # Exploit databases - actual attack code and techniques
    exploit_feeds:
      - "https://raw.githubusercontent.com/vulnersCom/vulners-whitelist/master/exploitdb.csv"
      - "https://www.exploit-db.com/feeds/exploits"
    
    # Malware feeds - known malicious software indicators
    malware_feeds:
      - "https://feodotracker.abuse.ch/downloads/ipblocklist.csv"
      - "https://malshare.com/daily/malshare.current.txt"
      - "https://urlhaus.abuse.ch/downloads/csv_recent/"
    
    # Phishing feeds - known phishing websites and campaigns
    phishing_feeds:
      - "https://openphish.com/feed.txt"
      - "https://phishing.army/download/phishing_army_blocklist.txt"
    
    # Update intervals for each feed type (in minutes)
    # Balance between freshness and load on sources
    update_intervals:
      cve_feeds: 360    # 6 hours - CVEs don't change frequently
      exploit_feeds: 60  # 1 hour - exploits appear regularly
      malware_feeds: 30  # 30 minutes - malware spreads quickly
      phishing_feeds: 15 # 15 minutes - phishing sites short-lived
  
  # Data validation and security for ingested data
  validation:
    # Enable hash validation for downloaded feeds
    # Verifies data integrity using cryptographic hashes
    enable_hash_validation: true
    
    # Enable TLS certificate validation
    # Ensures secure connections to feed sources
    enable_tls_validation: true
    
    # Enable signature verification
    # Verifies digital signatures on feed data
    enable_signature_verification: true
    
    # Tamper detection threshold
    # Statistical threshold for detecting data manipulation
    tamper_detection_threshold: 0.95
    
    # Quarantine suspicious data
    # Isolate potentially malicious data for analysis
    enable_quarantine: true
    
    # Quarantine duration (days)
    # How long to keep data in quarantine
    quarantine_duration_days: 7
  
  # Data storage settings for persistence
  storage:
    # Database configuration for structured data
    database:
      # Primary database type for application data
      type: "postgresql"  # Options: postgresql, mysql, sqlite
      
      # Connection string (overridden by environment variable CG_DATA_STORAGE_DATABASE_CONNECTION_STRING)
      # Format: dialect://user:password@host:port/database
      connection_string: "postgresql://user:pass@localhost:5432/cyberguard"
      
      # Connection pool settings for database efficiency
      pool_size: 20        # Number of persistent connections
      max_overflow: 10     # Additional connections when pool exhausted
      pool_timeout: 30     # Seconds to wait for connection
      pool_recycle: 3600   # Recycle connections after 1 hour
    
    # Vector database for AI embeddings and similarity search
    vector_database:
      type: "chromadb"  # Options: chromadb, pinecone, weaviate
      persist_directory: "./data/vectordb"  # Where to store vector data
      collection_name: "threat_embeddings"  # Collection for threat data
    
    # Cache configuration for performance
    cache:
      type: "redis"  # Options: redis, memcached - redis recommended
      host: "localhost"
      port: 6379
      db: 0           # Redis database number
      ttl_seconds: 3600  # Time-to-live for cache entries

# DEPLOYMENT & INFRASTRUCTURE
deployment:
  # Web dashboard configuration for security monitoring
  dashboard:
    # Dashboard server network settings
    host: "0.0.0.0"  # Listen on all network interfaces
    port: 8080        # Default dashboard port
    
    # Enable HTTPS for secure communication
    enable_https: true
    
    # SSL certificate paths for HTTPS
    # In production, use certificates from trusted CA
    ssl_cert: "./certs/cert.pem"  # Public certificate
    ssl_key: "./certs/key.pem"    # Private key
    
    # Authentication required for dashboard access
    auth_required: true
    
    # Session timeout (minutes)
    # Automatically logs out inactive users
    session_timeout: 60
    
    # Rate limiting to prevent abuse
    rate_limit: "100/minute"  # 100 requests per minute per user
    
    # CORS (Cross-Origin Resource Sharing) settings
    cors:
      enabled: true
      # FIXED: Changed from "*" to specific origins for security
      origins:
        - "https://dashboard.cyberguard.example.com"
        - "https://admin.cyberguard.example.com"
      # HTTP methods allowed from other origins
      methods:
        - "GET"
        - "POST"
        - "PUT"
        - "DELETE"
      # Headers allowed in cross-origin requests
      headers:
        - "Content-Type"
        - "Authorization"
  
  # REST API configuration for programmatic access
  api:
    # API server network settings
    host: "0.0.0.0"
    port: 8000        # Different from dashboard to avoid conflict
    
    # Enable HTTPS for API security
    enable_https: true
    
    # API version for compatibility management
    version: "v1"
    
    # Authentication configuration for API access
    authentication:
      # Authentication methods supported
      methods:
        - "api_key"  # Simple API key authentication
        - "jwt"      # JSON Web Tokens for stateless auth
        - "oauth2"   # OAuth 2.0 for third-party integration
      
      # API key validation settings
      api_key_header: "X-API-Key"  # HTTP header containing API key
      
      # JWT settings for token-based authentication
      # FIXED: Moved secret to environment variable
      jwt_secret_env_var: "CG_API_AUTHENTICATION_JWT_SECRET"  # Set in production
      jwt_algorithm: "HS256"       # HMAC with SHA-256
      jwt_expiry_minutes: 60       # Tokens expire after 1 hour
    
    # Rate limiting tiers for different user types
    rate_limits:
      anonymous: "10/minute"      # Unauthenticated users
      authenticated: "100/minute" # Regular users
      premium: "1000/minute"      # High-tier users
    
    # API documentation settings
    enable_docs: true      # Enable interactive API documentation
    docs_path: "/docs"     # Swagger UI path
    redoc_path: "/redoc"   # ReDoc alternative documentation
  
  # Reverse proxy configuration for existing applications
  reverse_proxy:
    # Enable reverse proxy mode
    # Acts as security wrapper for existing apps
    enabled: false
    
    # Proxy target - where to forward requests
    target: "http://localhost:3000"
    
    # Security headers to inject into proxied responses
    # Adds security headers to protected applications
    security_headers:
      X-Frame-Options: "DENY"                      # Prevent clickjacking
      X-Content-Type-Options: "nosniff"            # Prevent MIME sniffing
      X-XSS-Protection: "1; mode=block"           # Enable XSS protection
      Strict-Transport-Security: "max-age=31536000; includeSubDomains"  # Enforce HTTPS
      Content-Security-Policy: "default-src 'self'" # Control resource loading
      Referrer-Policy: "strict-origin-when-cross-origin"  # Control referrer info
    
    # Request/response modification capabilities
    modify_requests: true   # Inspect and modify incoming requests
    modify_responses: true  # Inspect and modify outgoing responses
  
  # Plugin system for extensibility
  plugins:
    # Enable plugin system for custom functionality
    enabled: true
    
    # Plugin directory where plugins are stored
    plugin_directory: "./plugins"
    
    # Auto-load plugins at startup
    auto_load: true
    
    # Enable sandboxing for plugin safety
    # Isolates plugins to prevent system damage
    enable_sandboxing: true
    
    # Allowed plugin permissions (principle of least privilege)
    allowed_permissions:
      - "read_config"     # Read configuration
      - "write_logs"      # Write to logs
      - "scan_network"    # Perform network scans
      - "analyze_traffic" # Analyze network traffic

# LOGGING & MONITORING
monitoring:
  # Logging configuration for system observability
  logging:
    # Log level controls verbosity
    # DEBUG > INFO > WARNING > ERROR > CRITICAL
    level: "INFO"
    
    # Log format template
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    
    # Date format in logs
    date_format: "%Y-%m-%d %H:%M:%S"
    
    # Log destinations - where logs are sent
    destinations:
      # Console output for development
      console:
        enabled: true
        format: "color"  # Options: color, plain
        
      # File output for persistence
      file:
        enabled: true
        path: "./logs/cyberguard.log"  # Log file location
        max_size: "100MB"               # Rotate when file reaches 100MB
        backup_count: 10                # Keep 10 rotated files
        rotation: "midnight"            # Also rotate daily
        
      # System logging (Linux syslog)
      syslog:
        enabled: false
        address: "/dev/log"    # Syslog socket
        facility: "local7"     # Syslog facility
        
      # Elasticsearch for log aggregation
      elasticsearch:
        enabled: false
        hosts: ["http://localhost:9200"]  # Elasticsearch cluster
        index: "cyberguard-logs"          # Index name
    
    # Structured logging for machine readability
    # Logs as JSON instead of plain text
    structured_logging: true
    
    # Log sensitive data (caution - security risk!)
    # Should be false in production
    log_sensitive_data: false
    
    # Log sanitization patterns
    # Automatically redacts sensitive information
    sanitization_patterns:
      - pattern: "(?i)password[=:]\s*(\S+)"    # Passwords
        replacement: "password=***"
      - pattern: "(?i)api_key[=:]\s*(\S+)"     # API keys
        replacement: "api_key=***"
      - pattern: "(?i)token[=:]\s*(\S+)"       # Tokens
        replacement: "token=***"
      - pattern: "(?i)credit.?card[=:]\s*(\S+)" # Credit cards
        replacement: "credit_card=***"
  
  # Metrics collection for performance monitoring
  metrics:
    # Enable metrics collection
    enabled: true
    
    # Metrics collection interval (seconds)
    # How often to collect system metrics
    collection_interval: 60
    
    # Export metrics to monitoring systems
    exporters:
      # Prometheus for time-series monitoring
      prometheus:
        enabled: true
        port: 9090  # Prometheus exposition port
        
      # StatsD for metric aggregation
      statsd:
        enabled: false
        host: "localhost"
        port: 8125
        
      # Datadog for cloud monitoring
      datadog:
        enabled: false
        api_key_env_var: "CG_MONITORING_METRICS_EXPORTERS_DATADOG_API_KEY"
    
    # Custom metrics to collect
    custom_metrics:
      - "requests_total"               # Total HTTP requests
      - "requests_duration_seconds"    # Request processing time
      - "threats_detected_total"       # Threats identified
      - "false_positives_total"        # Incorrect threat detections
      - "agent_confidence_avg"         # Average agent confidence
      - "scan_duration_seconds"        # Time to complete scans
      - "memory_usage_bytes"           # System memory usage
      - "cpu_usage_percent"            # CPU utilization
  
  # Alerting configuration for notifications
  alerting:
    # Enable alerting system
    enabled: true
    
    # Alert channels for different notification methods
    channels:
      # Email alerts
      email:
        enabled: true
        smtp_server: "smtp.gmail.com"
        smtp_port: 587
        from_address: "alerts@cyberguard.example.com"
        to_addresses:
          - "security-team@securecorp.com"
          - "oncall@securecorp.com"
      
      # Slack notifications
      slack:
        enabled: false
        webhook_url_env_var: "CG_MONITORING_ALERTING_CHANNELS_SLACK_WEBHOOK_URL"
        channel: "#security-alerts"
      
      # PagerDuty for on-call escalation
      pagerduty:
        enabled: false
        integration_key_env_var: "CG_MONITORING_ALERTING_CHANNELS_PAGERDUTY_INTEGRATION_KEY"
        severity_levels:
          critical: "critical"
          high: "error"
          medium: "warning"
          low: "info"
    
    # Alert conditions - when to trigger alerts
    conditions:
      - name: "critical_threat_detected"
        condition: "threat_level > 0.8 AND confidence > 0.7"
        severity: "critical"
        channel: "email"
        
      - name: "multiple_high_threats"
        condition: "threats_detected > 5 IN LAST 5 minutes"
        severity: "high"
        channel: "slack"
        
      - name: "system_high_load"
        condition: "cpu_usage > 80% FOR 5 minutes"
        severity: "medium"
        channel: "email"
        
      - name: "agent_failure"
        condition: "agent_status == 'failed'"
        severity: "high"
        channel: "pagerduty"
  
  # Health checks for system reliability
  health_checks:
    # Enable health check monitoring
    enabled: true
    
    # Health check interval (seconds)
    # How often to check system health
    interval: 30
    
    # Health check endpoints to monitor
    endpoints:
      - name: "api_health"
        url: "http://localhost:8000/health"
        timeout: 5          # Maximum wait time
        expected_status: 200 # Expected HTTP status
        
      - name: "database_health"
        query: "SELECT 1"   # Simple query to test DB
        timeout: 2
        
      - name: "agent_orchestrator_health"
        check: "agent_count > 0"  # Ensure agents are running
        timeout: 3
    
    # Failure thresholds for alerting
    failure_threshold: 3  # Number of consecutive failures before alert
    success_threshold: 2  # Number of successes to clear failure

# TRAINING & MODEL MANAGEMENT
training:
  # Training data configuration
  data:
    # Training dataset paths for different data types
    datasets:
      threat_intelligence: "./data/training/threat_intelligence.csv"
      vulnerability_data: "./data/training/vulnerabilities.json"
      attack_patterns: "./data/training/attack_patterns.parquet"
      normal_traffic: "./data/training/normal_traffic.pkl"
    
    # Data split ratios for machine learning
    split_ratios:
      training: 0.7      # 70% for training models
      validation: 0.15   # 15% for validation during training
      test: 0.15         # 15% for final evaluation
    
    # Data augmentation to improve model robustness
    augmentation:
      enabled: true
      techniques:
        - "noise_injection"           # Add random noise
        - "synthetic_samples"         # Generate synthetic examples
        - "adversarial_examples"      # Create hard-to-classify examples
        - "time_series_augmentation"  # Augment sequential data
      
      # Augmentation factor
      # 2.0 = double the dataset size
      factor: 2.0
  
  # Training hyperparameters for model optimization
  hyperparameters:
    # Optimizer settings for gradient descent
    optimizer:
      type: "adamw"       # Adam with weight decay
      learning_rate: 0.001 # Step size for updates
      weight_decay: 0.01   # L2 regularization strength
      beta1: 0.9          # Exponential decay rate for first moment
      beta2: 0.999        # Exponential decay rate for second moment
      epsilon: 1e-8       # Small constant for numerical stability
    
    # Learning rate scheduler for training stability
    scheduler:
      type: "cosine"      # Cosine annealing schedule
      warmup_steps: 1000  # Gradually increase LR at start
      total_steps: 100000 # Total training steps
      min_learning_rate: 1e-6 # Minimum LR
    
    # Batch processing settings
    batch_size: 32                     # Samples per batch
    gradient_accumulation_steps: 1     # Accumulate gradients over multiple batches
    max_grad_norm: 1.0                 # Clip gradients to prevent explosion
    
    # Training loop control
    epochs: 100                       # Maximum training epochs
    early_stopping_patience: 10       # Stop if no improvement for 10 epochs
    early_stopping_delta: 0.001       # Minimum improvement threshold
    
    # Mixed precision training for speed and memory
    mixed_precision: true
    amp_level: "O2"  # O0=FP32, O1=mixed, O2=almost FP16, O3=FP16
  
  # Model checkpointing for recovery and deployment
  checkpointing:
    # Enable checkpointing to save model progress
    enabled: true
    
    # Checkpoint directory for saved models
    directory: "./models/checkpoints"
    
    # Save interval in training steps
    save_interval_steps: 1000
    
    # Maximum checkpoints to keep (oldest deleted first)
    max_checkpoints: 5
    
    # Save only the best model (by validation metric)
    save_best_only: true
    
    # Metric to monitor for best model selection
    monitor_metric: "val_loss"  # Validation loss
    monitor_mode: "min"         # Lower is better for loss
  
  # Distributed training for large models/data
  distributed:
    # Enable distributed training across multiple GPUs/nodes
    enabled: false
    
    # Distributed backend for communication
    backend: "nccl"  # NVIDIA Collective Communications Library
    
    # Number of nodes (machines) in cluster
    num_nodes: 1
    
    # Number of GPUs per node
    gpus_per_node: 4
    
    # Master node for coordination
    master_addr: "localhost"
    master_port: 29500
    
    # Gradient synchronization across devices
    sync_batchnorm: true  # Sync batch normalization statistics

# PERFORMANCE & OPTIMIZATION
performance:
  # Memory optimization for large models
  memory:
    # Enable gradient checkpointing (trade compute for memory)
    # Recomputes gradients instead of storing them
    gradient_checkpointing: true
    
    # Enable CPU offloading (move some tensors to CPU)
    cpu_offloading: false
    
    # Model parallelism (split model across devices)
    model_parallelism: false
    
    # Pipeline parallelism (split layers across devices)
    pipeline_parallelism: false
    
    # Tensor parallelism (split tensors across devices)
    tensor_parallelism: false
    
    # Activation checkpointing (store/recompute activations)
    activation_checkpointing: true
    
    # Memory efficient attention implementations
    memory_efficient_attention: true
  
  # Inference optimization for production deployment
  inference:
    # Model quantization to reduce size and speed up inference
    quantization:
      enabled: true
      dtype: "int8"     # 8-bit integers (4x smaller than FP32)
      per_channel: true # Quantize each channel separately (more accurate)
      symmetric: true   # Symmetric quantization around zero
    
    # Model pruning to remove unimportant weights
    pruning:
      enabled: true
      amount: 0.2       # Remove 20% of weights
      method: "magnitude" # Prune smallest magnitude weights
      frequency: 1000   # Prune every 1000 steps
    
    # Knowledge distillation - train small model with large model guidance
    distillation:
      enabled: true
      temperature: 4.0  # Soften probability distributions
      alpha: 0.5        # 50% from teacher, 50% from ground truth
    
    # Inference engine selection
    engine: "onnxruntime"  # Options: pytorch, onnxruntime, tensorrt
    provider: "CUDAExecutionProvider"  # CPU, CUDA, TensorRT
    
    # Batch inference settings for throughput
    batch_inference: true      # Process multiple inputs together
    dynamic_batching: true     # Variable batch sizes
    max_batch_size: 64         # Maximum batch size
    batch_timeout_ms: 100      # Wait up to 100ms to form batch
  
  # Caching strategies for performance
  caching:
    # Enable response caching for repeated queries
    response_caching: true
    
    # Cache TTL (time-to-live) in seconds
    # How long to keep cached responses
    cache_ttl: 3600  # 1 hour
    
    # Cache backend for storage
    backend: "redis"  # Options: redis, memcached, memory
    
    # Cache invalidation strategy
    invalidation: "time_based"  # Options: time_based, event_based
    
    # Cache warming - pre-load cache at startup
    cache_warming: true
    warming_interval: 300  # Warm cache every 5 minutes

# BACKUP & DISASTER RECOVERY
backup:
  # Backup configuration for data protection
  configuration:
    # Enable automated backups
    enabled: true
    
    # Backup schedule using cron expression
    # Minute Hour Day Month DayOfWeek
    schedule: "0 2 * * *"  # Daily at 2 AM
    
    # Retention policy (days)
    # How long to keep backup files
    retention_days: 30
    
    # Backup types to perform
    types:
      - "database"             # Application database
      - "configurations"       # Configuration files
      - "models"               # Trained AI models
      - "logs"                 # System logs
      - "threat_intelligence"  # Threat data
    
    # Compression to reduce backup size
    compression: "gzip"  # Options: gzip, bzip2, lzma
    compression_level: 6 # 1=fast/low compression, 9=slow/high compression
    
    # Encryption for backup security
    encryption: true
    encryption_algorithm: "AES-256-GCM"
  
  # Storage locations for backup files
  storage:
    # Local storage for quick access
    local:
      enabled: true
      directory: "./backups"
      max_backups: 30  # Keep last 30 backups
    
    # Cloud storage for off-site protection
    cloud:
      enabled: false
      provider: "aws_s3"  # Options: aws_s3, azure_blob, gcp_storage
      bucket: "cyberguard-backups"
      region: "us-east-1"
      path: "backups/"
    
    # Remote server for additional redundancy
    remote:
      enabled: false
      protocol: "sftp"  # Options: sftp, scp, rsync
      host: "backup-server.example.com"
      port: 22
      path: "/backups/cyberguard/"
  
  # Recovery testing to ensure backups work
  recovery:
    # Test recovery periodically to verify backups
    test_recovery: true
    
    # Test interval (days)
    test_interval_days: 7  # Weekly recovery tests
    
    # Test methods for verification
    methods:
      - "integrity_check"        # Verify backup integrity
      - "partial_restore"        # Restore small portion
      - "full_restore_simulation" # Simulate full restore
    
    # Notification for recovery tests
    notify_on_test: true  # Alert when tests are run

# INTEGRATIONS & THIRD-PARTY SERVICES
integrations:
  # Security tools integration for extended capabilities
  security_tools:
    # Web Application Firewall (WAF) integration
    waf:
      enabled: false
      provider: "cloudflare"  # Options: cloudflare, aws_waf, azure_waf
      api_key_env_var: "CG_INTEGRATIONS_SECURITY_TOOLS_WAF_API_KEY"
      zone_id_env_var: "CG_INTEGRATIONS_SECURITY_TOOLS_WAF_ZONE_ID"
    
    # SIEM (Security Information and Event Management) integration
    siem:
      enabled: false
      providers:
        splunk:
          enabled: false
          host: "splunk.example.com"
          port: 8088
          token_env_var: "CG_INTEGRATIONS_SECURITY_TOOLS_SIEM_PROVIDERS_SPLUNK_TOKEN"
        
        elastic_siem:
          enabled: false
          hosts: ["http://elasticsearch:9200"]
          index: "security-events"
    
    # EDR (Endpoint Detection and Response) integration
    edr:
      enabled: false
      provider: "crowdstrike"  # Options: crowdstrike, carbonblack, sentinelone
      client_id_env_var: "CG_INTEGRATIONS_SECURITY_TOOLS_EDR_CLIENT_ID"
      client_secret_env_var: "CG_INTEGRATIONS_SECURITY_TOOLS_EDR_CLIENT_SECRET"
  
  # Cloud provider integrations
  cloud:
    aws:
      enabled: false
      access_key_id_env_var: "CG_INTEGRATIONS_CLOUD_AWS_ACCESS_KEY_ID"
      secret_access_key_env_var: "CG_INTEGRATIONS_CLOUD_AWS_SECRET_ACCESS_KEY"
      region: "us-east-1"
      services:
        - "guardduty"    # Threat detection service
        - "security_hub" # Security findings aggregation
        - "waf"          # Web Application Firewall
    
    azure:
      enabled: false
      tenant_id_env_var: "CG_INTEGRATIONS_CLOUD_AZURE_TENANT_ID"
      client_id_env_var: "CG_INTEGRATIONS_CLOUD_AZURE_CLIENT_ID"
      client_secret_env_var: "CG_INTEGRATIONS_CLOUD_AZURE_CLIENT_SECRET"
      subscription_id_env_var: "CG_INTEGRATIONS_CLOUD_AZURE_SUBSCRIPTION_ID"
    
    gcp:
      enabled: false
      project_id_env_var: "CG_INTEGRATIONS_CLOUD_GCP_PROJECT_ID"
      credentials_file: "./gcp_credentials.json"
      services:
        - "security_command_center" # Security and risk management
        - "cloud_armor"             # DDoS protection and WAF
  
  # Communication integrations for notifications
  communication:
    # Email service for alerts and reports
    email:
      enabled: true
      provider: "smtp"  # Options: smtp, sendgrid, mailgun
      smtp_server: "smtp.gmail.com"
      smtp_port: 587
      use_tls: true
      username_env_var: "CG_INTEGRATIONS_COMMUNICATION_EMAIL_USERNAME"
      password_env_var: "CG_INTEGRATIONS_COMMUNICATION_EMAIL_PASSWORD"
    
    # SMS notifications for urgent alerts
    sms:
      enabled: false
      provider: "twilio"  # Options: twilio, nexmo, plivo
      account_sid_env_var: "CG_INTEGRATIONS_COMMUNICATION_SMS_ACCOUNT_SID"
      auth_token_env_var: "CG_INTEGRATIONS_COMMUNICATION_SMS_AUTH_TOKEN"
      from_number: "+1234567890"
    
    # Voice notifications for critical alerts
    voice:
      enabled: false
      provider: "twilio"
      account_sid_env_var: "CG_INTEGRATIONS_COMMUNICATION_VOICE_ACCOUNT_SID"
      auth_token_env_var: "CG_INTEGRATIONS_COMMUNICATION_VOICE_AUTH_TOKEN"
      from_number: "+1234567890"

# ENVIRONMENT VARIABLE OVERRIDES - SECTION HEADER

# Note: All configuration values can be overridden by environment variables.
# The environment variable name is constructed as:
# CG_<SECTION>_<SUBSECTION>_<KEY> (uppercase with underscores)
#
# Examples:
#   CG_SYSTEM_ENVIRONMENT=staging
#   CG_SECURITY_ENCRYPTION_ALGORITHM=AES-256-GCM
#   CG_WEB_SECURITY_SCANNING_MAX_SCAN_DEPTH=5
#
# For nested values, use underscores to separate levels:
#   CG_AGENTS_WEB_THREAT_DETECTION_WEIGHT=0.9
#
# For arrays/lists, use comma-separated values:
#   CG_SECURITY_COMPLIANCE=GDPR,HIPAA,PCI-DSS
#
# For boolean values, use: true, false, 1, 0