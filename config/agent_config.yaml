# CYBERGUARD AGENT CONFIGURATION

# This file contains detailed configurations for each security agent
# in the CyberGuard multi-agent system. Each agent is specialized for
# specific security tasks and follows mHC coordination principles.
#
# WARNING: Never commit real API keys, passwords, or sensitive values
# to version control. Use environment variables or secret management.

# AGENT REGISTRY & COORDINATION

agent_registry:
  # Registry settings control how agents are discovered and managed
  registry_type: "dynamic"  # Options: "static" (pre-defined), "dynamic" (auto-discover), "hybrid"
  auto_discovery: true  # Automatically discover new agents at runtime
  discovery_interval: 60  # How often to check for new agents (in seconds)
  
  # Agent lifecycle management ensures agents are healthy and responsive
  lifecycle:
    # Heartbeat interval: How often agents report they're alive
    heartbeat_interval: 30  # seconds
    
    # Heartbeat timeout: How long to wait before considering agent dead
    heartbeat_timeout: 90  # seconds (3 missed heartbeats)
    
    # Graceful shutdown timeout: Time given to agents to finish processing
    shutdown_timeout: 30  # seconds
    
    # Auto-restart failed agents: Automatically restart agents that crash
    auto_restart: true
    
    # Maximum restart attempts: How many times to restart before giving up
    max_restart_attempts: 3
    
    # Restart delay: Wait between restart attempts (exponential backoff)
    restart_delay: 5  # seconds
  
  # Agent coordination settings for multi-agent collaboration
  coordination:
    # Coordination strategy: How agents make collective decisions
    strategy: "mhc"  # Options: "mhc" (Manifold-Constrained), "voting", "consensus", "hierarchical"
    
    # Coordination interval: How often agents coordinate (if continuous)
    coordination_interval: 1  # seconds
    
    # Maximum coordination time: Timeout for coordination to complete
    max_coordination_time: 5  # seconds
    
    # Enable parallel coordination: Process multiple coordination tasks simultaneously
    parallel_coordination: true
    
    # Number of coordination workers: Threads/processes for parallel coordination
    coordination_workers: 4

# WEB THREAT DETECTION AGENT (OWASP Top-10 Specialist)
web_threat_detection:
  # Agent metadata for identification and tracking
  metadata:
    agent_id: "threat_detection_001"  # Unique identifier for this agent instance
    name: "Web Threat Detection Agent"  # Human-readable name
    description: "Specialized in detecting OWASP Top-10 web vulnerabilities"  # What it does
    version: "1.0.0"  # Agent version for compatibility checking
    author: "CyberGuard Security Team"  # Development team
    created: "2024-01-15"  # Creation date (YYYY-MM-DD)
    last_updated: "2024-01-15"  # Last update date
  
  # Detection capabilities define what threats this agent can identify
  capabilities:
    primary:  # Core OWASP Top-10 vulnerabilities
      - "cross_site_scripting"  # XSS: Malicious scripts injected into web pages
      - "sql_injection"  # SQLi: Injecting SQL commands into queries
      - "cross_site_request_forgery"  # CSRF: Unauthorized commands from trusted users
      - "server_side_request_forgery"  # SSRF: Forcing server to make requests to internal systems
      - "command_injection"  # Injecting OS commands via vulnerable parameters
      - "path_traversal"  # Accessing files outside web root directory
      - "xml_external_entity"  # XXE: Exploiting XML parsers to read files
      - "insecure_deserialization"  # Executing code during deserialization
      - "broken_access_control"  # Improper enforcement of access permissions
      - "security_misconfiguration"  # Default configs, error messages, etc.
    
    secondary:  # Additional web vulnerabilities
      - "open_redirect"  # Redirecting users to malicious sites
      - "server_side_template_injection"  # SSTI: Injecting template code
      - "file_upload_vulnerabilities"  # Malicious file uploads
      - "http_parameter_pollution"  # HPP: Manipulating HTTP parameters
      - "insecure_cors"  # Cross-Origin Resource Sharing misconfigurations
    
    advanced:  # Modern/advanced attack techniques
      - "jwt_attacks"  # JSON Web Token manipulation attacks
      - "graphql_injection"  # GraphQL-specific injection attacks
      - "websocket_attacks"  # Attacks on WebSocket connections
      - "prototype_pollution"  # JavaScript prototype chain pollution
  
  # Detection rules and patterns for identifying specific vulnerabilities
  detection_rules:
    xss:  # Cross-Site Scripting detection rules
      reflected_patterns:  # Patterns for reflected XSS (malicious input in response)
        - "<script>.*</script>"  # Script tags
        - "javascript:"  # JavaScript protocol in URLs
        - "onload="  # Event handler attributes
        - "onerror="  # Error event handlers
        - "onclick="  # Click event handlers
        - "onmouseover="  # Mouseover event handlers
        - "eval\\("  # Dangerous eval() function calls (escaped parentheses)
        - "alert\\("  # Alert popups (common in XSS testing) (escaped parentheses)
        - "document\\.cookie"  # Cookie access attempts (escaped dot)
        - "window\\.location"  # Page redirection attempts (escaped dot)
      
      stored_patterns:  # Patterns for stored XSS (malicious code stored on server)
        - "data:text/html"  # Data URLs containing HTML
        - "<iframe"  # Inline frame tags
        - "<object"  # Object embedding tags
        - "<embed"  # Media embedding tags
        - "<svg"  # SVG vector graphics
        - "<math"  # MathML content
      
      dom_indicators:  # Indicators of DOM-based XSS vulnerabilities
        - "innerHTML"  # Direct HTML insertion (dangerous)
        - "outerHTML"  # Outer HTML manipulation
        - "document.write"  # Direct document writing
        - "eval\\("  # JavaScript evaluation (escaped parentheses)
        - "setTimeout"  # Timed execution
        - "setInterval"  # Repeated execution
        - "Function\\("  # Dynamic function creation (escaped parentheses)
    
    sql_injection:  # SQL Injection detection rules
      patterns:  # Common SQL injection payloads
        - "' OR '1'='1"  # Basic authentication bypass
        - "' OR '1'='1' --"  # Authentication bypass with comment
        - "' UNION SELECT"  # UNION-based injection
        - "'; DROP TABLE"  # Table destruction attempt
        - "' OR 1=1 --"  # Boolean-based injection
        - "' OR 1=1 #"  # MySQL comment injection
        - "' OR 'a'='a"  # Alternative boolean injection
        - "') OR ('a'='a"  # Parenthesis-based injection
        - "1' ORDER BY"  # ORDER BY injection for column counting
        - "admin' --"  # Admin login bypass
        - "' AND 1=1"  # Boolean true condition
        - "' AND 1=0"  # Boolean false condition
      
      blind_patterns:  # Blind SQL injection indicators (no visible output)
        - "waitfor delay"  # MSSQL time delay
        - "pg_sleep"  # PostgreSQL sleep function
        - "sleep\\("  # Generic sleep function (escaped parentheses)
        - "benchmark\\("  # MySQL benchmark function (escaped parentheses)
      
      time_based:  # Time-based blind SQL injection detection
        enabled: true  # Enable time-based detection
        threshold_ms: 5000  # Response time threshold (5 seconds)
        test_payloads:  # Payloads to test for time-based injection
          - "' AND sleep(5) --"  # Generic sleep test
          - "' AND pg_sleep(5) --"  # PostgreSQL sleep test
          - "'; WAITFOR DELAY '00:00:05' --"  # MSSQL wait test
    
    csrf:  # Cross-Site Request Forgery detection
      detection_methods:  # Methods to detect CSRF vulnerabilities
        token_check: true  # Check for CSRF tokens in requests
        samesite_check: true  # Check SameSite cookie attribute
        origin_check: true  # Check Origin/Referer headers
        state_changing_check: true  # Check state-changing methods without protection
      
      state_changing_methods:  # HTTP methods that change server state
        - "POST"  # Create resources
        - "PUT"  # Update resources
        - "DELETE"  # Delete resources
        - "PATCH"  # Partial updates
      
      token_patterns:  # Common CSRF token parameter names
        - "csrf_token"  # Generic CSRF token
        - "csrfmiddlewaretoken"  # Django CSRF token
        - "authenticity_token"  # Rails authenticity token
        - "X-CSRF-Token"  # Header-based CSRF token
        - "X-XSRF-Token"  # Angular/header CSRF token
    
    ssrf:  # Server-Side Request Forgery detection
      internal_ip_patterns:  # Patterns indicating internal network access
        - "127.0.0.1"  # Localhost
        - "localhost"  # Localhost hostname
        - "0.0.0.0"  # All interfaces
        - "169.254.169.254"  # AWS metadata service
        - "192.168."  # Private network range (Class C)
        - "10."  # Private network range (Class A)
        - "172.16."  # Private network range start (Class B)
        - "172.31."  # Private network range end (Class B)
      
      dangerous_protocols:  # Potentially dangerous URL protocols
        - "file://"  # Local file access
        - "gopher://"  # Legacy protocol with security issues
        - "dict://"  # Dictionary protocol (can access services)
        - "ldap://"  # LDAP protocol (can access directory services)
        - "tftp://"  # Trivial FTP (no authentication)
      
      cloud_metadata:  # Cloud provider metadata endpoints
        aws: "169.254.169.254"  # AWS instance metadata service
        azure: "169.254.169.254"  # Azure instance metadata service
        gcp: "metadata.google.internal"  # GCP metadata service
        digitalocean: "169.254.169.254"  # DigitalOcean metadata service
  
  # Confidence thresholds determine when findings are reported
  confidence_thresholds:
    xss:  # Cross-Site Scripting confidence levels
      certain: 0.9  # 90%+ confidence (definitely XSS)
      high: 0.7  # 70%+ confidence (likely XSS)
      medium: 0.5  # 50%+ confidence (possible XSS)
      low: 0.3  # 30%+ confidence (unlikely but suspicious)
    
    sql_injection:  # SQL Injection confidence levels
      certain: 0.95  # 95%+ confidence (definitely SQLi)
      high: 0.8  # 80%+ confidence (likely SQLi)
      medium: 0.6  # 60%+ confidence (possible SQLi)
      low: 0.4  # 40%+ confidence (suspicious SQL patterns)
    
    csrf:  # CSRF confidence levels
      certain: 0.85  # 85%+ confidence (definitely vulnerable)
      high: 0.6  # 60%+ confidence (likely vulnerable)
      medium: 0.4  # 40%+ confidence (possible vulnerability)
      low: 0.2  # 20%+ confidence (missing best practices)
    
    ssrf:  # SSRF confidence levels
      certain: 0.9  # 90%+ confidence (definitely SSRF attempt)
      high: 0.7  # 70%+ confidence (likely SSRF attempt)
      medium: 0.5  # 50%+ confidence (possible SSRF)
      low: 0.3  # 30%+ confidence (suspicious URL patterns)
  
  # Performance settings for optimization and resource management
  performance:
    analysis_timeout: 10  # Maximum time for analysis (seconds)
    max_concurrent: 5  # Maximum simultaneous analyses per agent
    enable_caching: true  # Cache pattern matching results for performance
    cache_ttl: 3600  # Cache time-to-live (seconds, 1 hour)
    matching_engine: "regex"  # Pattern matching engine: "regex", "aho_corasick", "boyer_moore"
    parallel_matching: true  # Use parallel processing for pattern matching

# TRAFFIC ANOMALY DETECTION AGENT
traffic_anomaly:
  metadata:
    agent_id: "traffic_anomaly_001"
    name: "Traffic Anomaly Detection Agent"
    description: "Detects anomalous patterns in web traffic using statistical methods"
    version: "1.0.0"
  
  # Statistical methods for detecting anomalies in traffic patterns
  statistical_methods:
    moving_average:  # Simple moving average for baseline establishment
      enabled: true
      window_size: 100  # Number of data points in moving window
      sensitivity: 2.0  # Standard deviations from mean to trigger alert
    
    exponential_smoothing:  # Weighted average giving more importance to recent data
      enabled: true
      alpha: 0.3  # Smoothing factor for level (0 < α ≤ 1)
      beta: 0.1  # Smoothing factor for trend (0 < β ≤ 1)
      gamma: 0.1  # Smoothing factor for seasonality (0 < γ ≤ 1)
    
    z_score:  # Standard score measuring deviation from mean
      enabled: true
      threshold: 3.0  # Z-score threshold (typically 2-3 for anomaly)
    
    percentile:  # Percentile-based anomaly detection
      enabled: true
      upper_percentile: 99  # 99th percentile (top 1% is anomalous)
      lower_percentile: 1  # 1st percentile (bottom 1% is anomalous)
  
  # Time series analysis for detecting patterns over time
  time_series:
    seasonality:  # Detect repeating patterns (daily, weekly, monthly)
      enabled: true
      periods:  # Common seasonal periods in seconds
        - 86400  # Daily seasonality (24 hours * 60 minutes * 60 seconds)
        - 604800  # Weekly seasonality (7 days * 24 hours * 60 minutes * 60 seconds)
        - 2592000  # Monthly seasonality (approx 30 days)
    
    trend:  # Detect upward/downward trends in traffic
      enabled: true
      method: "holt_winters"  # Options: "linear", "exponential", "holt_winters"
    
    change_points:  # Detect abrupt changes in traffic patterns
      enabled: true
      method: "pelt"  # Options: "pelt", "binseg", "window"
      penalty: "bic"  # Penalty function: "bic" (Bayesian), "aic" (Akaike)
  
  # Feature extraction defines what metrics to analyze
  features:
    request_features:  # Features extracted from HTTP requests
      - "request_rate"  # Requests per second/minute
      - "unique_ips"  # Number of unique IP addresses
      - "request_size_mean"  # Average request size in bytes
      - "request_size_std"  # Standard deviation of request sizes
      - "response_time_mean"  # Average server response time
      - "response_time_std"  # Standard deviation of response times
      - "status_code_distribution"  # Distribution of HTTP status codes
      - "user_agent_entropy"  # Diversity of user agents (Shannon entropy)
      - "referrer_entropy"  # Diversity of referrer URLs
      - "path_depth_mean"  # Average URL path depth (/a/b/c has depth 3)
    
    session_features:  # Features extracted from user sessions
      - "session_duration"  # How long sessions last
      - "requests_per_session"  # Average requests per session
      - "unique_endpoints_per_session"  # Different endpoints accessed per session
      - "session_interval_mean"  # Average time between sessions
      - "session_interval_std"  # Standard deviation between sessions
    
    behavioral_features:  # User interaction features
      - "click_rate"  # Clicks per minute
      - "scroll_depth"  # How far users scroll (percentage)
      - "form_submission_rate"  # Form submissions per session
      - "ajax_request_ratio"  # AJAX vs regular request ratio
      - "api_to_html_ratio"  # API calls vs HTML page requests ratio
  
  # Anomaly detection models (machine learning algorithms)
  models:
    isolation_forest:  # Tree-based ensemble method for anomaly detection
      enabled: true
      n_estimators: 100  # Number of trees in the forest
      contamination: 0.1  # Expected proportion of anomalies in data
      max_features: 1.0  # Proportion of features to consider per split
    
    one_class_svm:  # Support Vector Machine for one-class classification
      enabled: true
      kernel: "rbf"  # Radial Basis Function kernel
      nu: 0.1  # Upper bound on fraction of training errors
      gamma: "auto"  # Kernel coefficient (auto = 1/n_features)
    
    autoencoder:  # Neural network for unsupervised anomaly detection
      enabled: true
      encoding_dim: 32  # Size of compressed representation
      hidden_layers: [64, 32]  # Hidden layer sizes (encoder)
      activation: "relu"  # Activation function
      reconstruction_threshold: 0.95  # Reconstruction error threshold
    
    lstm:  # Long Short-Term Memory for sequence anomaly detection
      enabled: false  # Disabled by default (requires more resources)
      sequence_length: 10  # Number of time steps in input sequence
      lstm_units: 50  # Number of LSTM units/cells
      dropout: 0.2  # Dropout rate for regularization
  
  # Alert thresholds for different anomaly severity levels
  alert_thresholds:
    anomaly_score:  # Thresholds for anomaly scores (0-1)
      critical: 0.9  # >90% anomaly score = critical
      high: 0.7  # >70% anomaly score = high
      medium: 0.5  # >50% anomaly score = medium
      low: 0.3  # >30% anomaly score = low
    
    rate_change:  # Thresholds for rate of change (multiplicative factor)
      critical: 5.0  # 500% increase = critical
      high: 3.0  # 300% increase = high
      medium: 2.0  # 200% increase = medium
      low: 1.5  # 150% increase = low

# BOT & ABUSE DETECTION AGENT
bot_detection:
  metadata:
    agent_id: "bot_detection_001"
    name: "Bot & Abuse Detection Agent"
    description: "Identifies automated bots, scrapers, and abusive traffic"
    version: "1.0.0"
  
  # Bot signatures database for known bots and malicious tools
  bot_signatures:
    user_agents:  # Known legitimate bot user agents (search engines, etc.)
      - "Googlebot"  # Google web crawler
      - "Bingbot"  # Microsoft Bing crawler
      - "Slurp"  # Yahoo crawler
      - "DuckDuckBot"  # DuckDuckGo crawler
      - "Baiduspider"  # Baidu crawler
      - "YandexBot"  # Yandex crawler
      - "facebookexternalhit"  # Facebook link preview bot
      - "Twitterbot"  # Twitter card preview bot
      - "LinkedInBot"  # LinkedIn preview bot
      - "WhatsApp"  # WhatsApp link preview
      - "TelegramBot"  # Telegram preview bot
      - "Discordbot"  # Discord link preview
      - "Slackbot"  # Slack link preview
      - "Alexa"  # Amazon Alexa crawler
      - "PetalBot"  # Huawei Petal search bot
    
    malicious_patterns:  # User agents of known malicious tools/scanners
      - "masscan"  # Mass port scanner
      - "nmap"  # Network mapper/scanner
      - "sqlmap"  # Automated SQL injection tool
      - "nikto"  # Web server scanner
      - "dirbuster"  # Directory brute forcer
      - "gobuster"  # Directory/file brute forcer
      - "ffuf"  # Fast web fuzzer
      - "wpscan"  # WordPress vulnerability scanner
      - "joomscan"  # Joomla vulnerability scanner
      - "acunetix"  # Commercial vulnerability scanner
      - "nessus"  # Vulnerability scanner
      - "openvas"  # Open vulnerability scanner
      - "zap"  # OWASP ZAP proxy
      - "burp"  # Burp Suite proxy
    
    header_analysis:  # Analyze HTTP headers for bot detection
      suspicious_headers:  # Missing headers that legitimate browsers usually have
        - missing: "User-Agent"  # All browsers send User-Agent
          weight: 0.8  # High weight - very suspicious
        - missing: "Accept"  # Accept header is standard
          weight: 0.3  # Medium weight - somewhat suspicious
        - missing: "Accept-Language"  # Language preference
          weight: 0.2  # Low weight - slightly suspicious
        - missing: "Accept-Encoding"  # Compression support
          weight: 0.1  # Very low weight - minor indicator
      
      consistency_checks:  # Check header consistency (bots often inconsistent)
        user_agent_consistency: true  # Check if User-Agent format is consistent
        accept_header_consistency: true  # Check Accept header patterns
        language_header_consistency: true  # Check Accept-Language patterns
  
  # Behavioral analysis for detecting non-human patterns
  behavioral_analysis:
    rate_limiting:  # Detect excessive request rates
      enabled: true
      requests_per_minute: 100  # Threshold for requests per minute
      requests_per_hour: 1000  # Threshold for requests per hour
      requests_per_day: 10000  # Threshold for requests per day
      
      burst_detection: true  # Detect sudden bursts of requests
      burst_window: 10  # Time window for burst detection (seconds)
      burst_threshold: 50  # Requests in burst window to trigger
    
    request_patterns:  # Analyze request patterns for automation
      sequential_scanning:  # Detect sequential numeric/letter scanning
        enabled: true
        threshold: 0.8  # 80% sequential requests = likely scanning
        
      directory_traversal:  # Detect deep directory traversal
        enabled: true
        depth_threshold: 5  # More than 5 directory levels = suspicious
        
      parameter_fuzzing:  # Detect parameter enumeration/fuzzing
        enabled: true
        unique_params_threshold: 50  # More than 50 unique parameters = fuzzing
        
      missing_referrer:  # Requests without referrer (common with bots)
        enabled: true
        threshold: 0.7  # 70% requests without referrer = suspicious
    
    timing_analysis:  # Analyze timing patterns (bots often too precise)
      interval_consistency:  # Check if request intervals are too consistent
        enabled: true
        threshold: 0.1  # Maximum allowed standard deviation in seconds
        
      human_like_delays:  # Check for human-like random delays
        enabled: true
        min_delay: 0.1  # Minimum delay between requests (seconds)
        max_delay: 5.0  # Maximum delay between requests (seconds)
        required_percentage: 0.7  # 70% of requests should have human-like delays
  
  # Machine learning models for advanced bot detection
  ml_models:
    features:  # Feature extraction for ML models
      - "requests_per_second"  # Request rate
      - "unique_endpoints"  # Number of different URLs accessed
      - "request_entropy"  # Randomness in request patterns
      - "parameter_variety"  # Diversity of parameter names/values
      - "header_completeness"  # Completeness of HTTP headers
      - "timing_consistency"  # Consistency in request timing
      - "geolocation_diversity"  # Geographic spread of requests
      - "asn_diversity"  # Diversity of Autonomous System Numbers
      - "session_duration"  # Length of sessions
      - "inter_request_time_mean"  # Average time between requests
      - "inter_request_time_std"  # Standard deviation between requests
    
    classifiers:  # ML classification algorithms
      random_forest:  # Ensemble of decision trees
        enabled: true
        n_estimators: 100  # Number of trees in forest
        max_depth: 10  # Maximum depth of each tree
        
      gradient_boosting:  # Sequential ensemble learning
        enabled: true
        n_estimators: 100  # Number of boosting stages
        learning_rate: 0.1  # Step size shrinkage
        
      neural_network:  # Deep learning approach
        enabled: false  # Disabled by default (requires more data)
        layers: [64, 32, 16]  # Layer sizes (input -> hidden -> output)
        activation: "relu"  # Rectified Linear Unit activation
        dropout: 0.2  # Dropout rate for regularization
  
  # Challenge-response mechanisms for suspicious traffic
  challenges:
    captcha:  # CAPTCHA challenges for suspected bots
      enabled: true
      type: "recaptcha_v3"  # Options: "recaptcha_v2", "recaptcha_v3", "hcaptcha"
      score_threshold: 0.5  # Scores below this trigger CAPTCHA (0-1, lower = more bot-like)
      site_key: "${RECAPTCHA_SITE_KEY}"  # From environment variable (NEVER hardcode)
      secret_key: "${RECAPTCHA_SECRET_KEY}"  # From environment variable
    
    javascript:  # JavaScript challenges (bots may not execute JS)
      enabled: true
      challenge_types:  # Types of JavaScript challenges
        - "cookie_setting"  # Set and read back cookies
        - "dom_manipulation"  # Modify and read DOM elements
        - "ajax_request"  # Make AJAX requests
        - "canvas_rendering"  # Canvas drawing and reading
      
      difficulty: "medium"  # Challenge difficulty: "easy", "medium", "hard"
    
    behavioral:  # Behavioral biometric challenges
      enabled: true
      mouse_movement: true  # Analyze mouse movement patterns
      keystroke_dynamics: true  # Analyze typing rhythm and patterns
      scroll_behavior: true  # Analyze scrolling patterns
      touch_gestures: true  # Analyze touch/mobile gestures

# MALWARE PAYLOAD DETECTION AGENT
malware_payload:
  metadata:
    agent_id: "malware_agent_001"
    name: "Malware Payload Detection Agent"
    description: "Detects malicious payloads, file uploads, and code injections"
    version: "1.0.0"
  
  # YARA rules configuration for pattern-based malware detection
  yara_rules:
    categories:  # Categories of YARA rules to load
      - "webshells"  # Web shells and backdoors
      - "backdoors"  # Remote access tools
      - "ransomware"  # File-encrypting malware
      - "trojans"  # Disguised malicious software
      - "spyware"  # Information-stealing malware
      - "cryptominers"  # Cryptocurrency mining malware
      - "botnets"  # Botnet command and control
      - "exploit_kits"  # Automated exploitation frameworks
      - "obfuscated_code"  # Obfuscated/encoded malware
      - "suspicious_patterns"  # General suspicious patterns
    
    update:  # YARA rule update settings
      enabled: true
      interval: 3600  # Check for updates every hour (seconds)
      sources:  # Sources for YARA rule updates
        - "https://rules.yara-signatures.org/"  # Official YARA rules
        - "https://github.com/Yara-Rules/rules"  # Community rules
        - "https://github.com/Neo23x0/signature-base"  # Florian Roth's rules
    
    compilation:  # YARA rule compilation settings
      optimize: true  # Optimize rules for faster scanning
      stack_size: 16384  # Maximum stack size for rule evaluation
      max_strings_per_rule: 10000  # Maximum strings per rule
      max_match_data: 512  # Maximum bytes to extract for matched strings
  
  # File type analysis for detecting malicious files
  file_types:
    dangerous_extensions:  # File extensions that can contain executable code
      - ".php"  # PHP scripts
      - ".php3"  # PHP3 scripts
      - ".php4"  # PHP4 scripts
      - ".php5"  # PHP5 scripts
      - ".phtml"  # PHP HTML files
      - ".asp"  # ASP scripts
      - ".aspx"  # ASP.NET scripts
      - ".jsp"  # Java Server Pages
      - ".jspx"  # JSP XML files
      - ".war"  # Web application archive
      - ".jar"  # Java archive
      - ".exe"  # Windows executable
      - ".dll"  # Dynamic link library
      - ".bat"  # Batch file
      - ".cmd"  # Command script
      - ".ps1"  # PowerShell script
      - ".sh"  # Shell script
      - ".py"  # Python script
      - ".pl"  # Perl script
      - ".rb"  # Ruby script
    
    suspicious_mime_types:  # MIME types that should raise suspicion
      - "application/x-php"  # PHP files
      - "application/x-httpd-php"  # PHP files (Apache)
      - "application/x-msdownload"  # Windows executables
      - "application/x-msdos-program"  # DOS executables
      - "application/x-dosexec"  # DOS/Windows executables
      - "application/x-executable"  # Generic executables
      - "application/x-shellscript"  # Shell scripts
    
    magic_numbers:  # File signature analysis (magic bytes)
      enabled: true
      database: "config/magic_numbers.db"  # Database of file signatures
      max_file_size: 10485760  # Maximum file size to analyze (10MB)
  
  # Heuristic analysis for detecting obfuscated or suspicious code
  heuristics:
    obfuscation:  # Detect code obfuscation techniques
      enabled: true
      techniques:  # Common obfuscation techniques
        - "base64_encoding"  # Base64 encoding
        - "hex_encoding"  # Hexadecimal encoding
        - "rot13"  # ROT13 cipher
        - "gzinflate"  # Gzip inflation
        - "str_rot13"  # PHP ROT13 function
        - "eval_base64_decode"  # Eval with base64 decode
        - "gzinflate_base64_decode"  # Gzip inflate with base64
      
      patterns:  # Regex patterns for obfuscated code
        - "eval\\(base64_decode"  # PHP eval with base64
        - "gzinflate\\(base64_decode"  # PHP gzinflate with base64
        - "str_rot13\\(base64_decode"  # PHP ROT13 with base64
        - "preg_replace.*\\/e"  # PHP preg_replace with /e modifier
        - "create_function"  # PHP dynamic function creation
        - "assert\\("  # PHP assert function (often abused)
        - "system\\("  # System command execution
        - "shell_exec\\("  # Shell command execution
        - "passthru\\("  # Passthru command execution
        - "exec\\("  # Exec command execution
        - "proc_open"  # Process opening
        - "popen"  # Pipe opening
    
    webshells:  # Web shell detection heuristics
      enabled: true
      common_functions:  # Functions commonly used in web shells
        - "phpinfo"  # PHP information disclosure
        - "system"  # System command execution
        - "shell_exec"  # Shell command execution
        - "exec"  # Command execution
        - "passthru"  # Passthru execution
        - "proc_open"  # Process opening
        - "popen"  # Pipe opening
        - "curl_exec"  # cURL execution
        - "file_get_contents"  # File reading
        - "fopen"  # File opening
        - "fwrite"  # File writing
      
      patterns:  # Common web shell patterns
        - "<\\?php @eval"  # PHP eval with error suppression
        - "<\\?php system"  # PHP system command
        - "<\\?php shell_exec"  # PHP shell execution
        - "<\\?php passthru"  # PHP passthru
        - "<\\?php assert"  # PHP assert
        - "<\\?php create_function"  # PHP dynamic function
    
    ransomware:  # Ransomware detection patterns
      enabled: true
      patterns:  # Keywords and patterns in ransomware
        - "encrypt"  # Encryption functions
        - "decrypt"  # Decryption functions
        - "ransom"  # Ransom-related terms
        - "bitcoin"  # Cryptocurrency
        - "payment"  # Payment demands
        - "aes_256"  # AES-256 encryption
        - "rsa_2048"  # RSA encryption
        - "your files have been encrypted"  # Common ransom note
        - "pay to decrypt"  # Payment demand
  
  # Sandbox analysis for dynamic malware analysis (requires careful isolation)
  sandbox:
    enabled: false  # DISABLED by default - requires Docker and careful security
    docker_image: "cyberguard/sandbox:latest"  # Sandbox container image
    timeout: 300  # Maximum execution time (seconds)
    memory_limit: "512m"  # Memory limit for sandbox
    cpu_limit: "1.0"  # CPU limit (1 core)
    network_mode: "none"  # No network access in sandbox
    
    environments:  # Analysis environments for different file types
      - name: "php"
        version: "8.1"
        extensions: ["curl", "gd", "mysqli"]  # Common PHP extensions
      
      - name: "node"
        version: "18"
        packages: ["express", "axios"]  # Common Node.js packages
      
      - name: "python"
        version: "3.10"
        packages: ["flask", "requests"]  # Common Python packages
  
  # Threat intelligence integration for malware identification
  threat_intelligence:
    virustotal:  # VirusTotal API integration
      enabled: false  # Disabled - requires API key
      api_key: "${VIRUSTOTAL_API_KEY}"  # From environment variable
      query_limit: 4  # API queries per minute (free tier limit)
      
    hybrid_analysis:  # Hybrid Analysis (CrowdStrike) integration
      enabled: false  # Disabled - requires API key
      api_key: "${HYBRID_ANALYSIS_API_KEY}"  # From environment variable
      
    abuse_ch:  # Abuse.ch threat intelligence feeds
      enabled: true
      feeds:  # Free threat intelligence feeds
        - "https://urlhaus.abuse.ch/downloads/csv_recent/"  # Malicious URLs
        - "https://feodotracker.abuse.ch/downloads/ipblocklist.csv"  # C2 servers

# EXPLOIT CHAIN REASONING AGENT
exploit_chain_reasoning:
  metadata:
    agent_id: "exploit_chain_001"
    name: "Exploit Chain Reasoning Agent"
    description: "Analyzes multi-step attack chains and lateral movement"
    version: "1.0.0"
  
  # Attack graph construction for modeling multi-step attacks
  attack_graph:
    node_types:  # Types of nodes in the attack graph
      vulnerabilities:  # Vulnerability/technique nodes
        - "initial_access"  # Initial compromise
        - "execution"  # Code execution
        - "persistence"  # Maintaining access
        - "privilege_escalation"  # Gaining higher privileges
        - "defense_evasion"  # Avoiding detection
        - "credential_access"  # Stealing credentials
        - "discovery"  # Network/system discovery
        - "lateral_movement"  # Moving through network
        - "collection"  # Data collection
        - "exfiltration"  # Data theft
        - "command_and_control"  # C2 communication
        - "impact"  # Final impact (destruction, ransom, etc.)
      
      assets:  # System/network asset nodes
        - "web_server"  # Web servers
        - "database"  # Databases
        - "api_server"  # API servers
        - "load_balancer"  # Load balancers
        - "cdn"  # Content Delivery Networks
        - "firewall"  # Firewalls
        - "waf"  # Web Application Firewalls
        - "dns_server"  # DNS servers
        - "mail_server"  # Email servers
        - "file_server"  # File servers
    
    edge_types:  # Relationships between nodes
      - "exploits"  # Node A exploits vulnerability in Node B
      - "requires"  # Node A requires Node B
      - "leads_to"  # Node A leads to Node B
      - "depends_on"  # Node A depends on Node B
      - "mitigates"  # Node A mitigates Node B
      - "detects"  # Node A detects Node B
    
    algorithms:  # Graph algorithms for analysis
      path_finding:  # Find attack paths
        algorithm: "dijkstra"  # Options: "dijkstra", "astar", "bellman_ford"
        max_path_length: 10  # Maximum steps in attack chain
        
      community_detection:  # Find related attack clusters
        algorithm: "louvain"  # Options: "louvain", "girvan_newman", "label_propagation"
        
      centrality:  # Identify critical nodes
        metrics:  # Centrality metrics
          - "degree_centrality"  # Number of connections
          - "betweenness_centrality"  # Bridge positions
          - "closeness_centrality"  # Distance to other nodes
          - "eigenvector_centrality"  # Influence based on neighbors
  
  # MITRE ATT&CK Framework integration for standardized terminology
  mitre_attack:
    enabled: true
    version: "13.0"  # MITRE ATT&CK version
    
    tactics:  # ATT&CK Tactics (attack phases)
      TA0043: "Reconnaissance"  # Gathering information
      TA0042: "Resource Development"  # Building infrastructure
      TA0001: "Initial Access"  # First compromise
      TA0002: "Execution"  # Running malicious code
      TA0003: "Persistence"  # Maintaining access
      TA0004: "Privilege Escalation"  # Gaining higher privileges
      TA0005: "Defense Evasion"  # Avoiding detection
      TA0006: "Credential Access"  # Stealing credentials
      TA0007: "Discovery"  # Learning about environment
      TA0008: "Lateral Movement"  # Moving through network
      TA0009: "Collection"  # Gathering data
      TA0011: "Command and Control"  # Remote control
      TA0010: "Exfiltration"  # Data theft
      TA0040: "Impact"  # Final impact
    
    techniques_database: "config/mitre_attack.json"  # ATT&CK techniques database
    update_interval: 86400  # Update database daily (seconds)
  
  # Chain detection for identifying multi-step attacks
  chain_detection:
    common_chains:  # Pre-defined common attack chains
      web_app_chain:  # Typical web application compromise chain
        stages:  # Attack stages in sequence
          - "initial_access:sql_injection"  # Start with SQL injection
          - "execution:command_injection"  # Gain command execution
          - "persistence:web_shell"  # Install web shell
          - "privilege_escalation:suid_binary"  # Escalate privileges
          - "lateral_movement:ssh_bruteforce"  # Move to other systems
          - "exfiltration:compressed_data"  # Steal compressed data
        
      phishing_chain:  # Phishing to ransomware chain
        stages:
          - "initial_access:phishing"  # Phishing email
          - "execution:macro_enabled_doc"  # Malicious document
          - "persistence:scheduled_task"  # Create persistence
          - "defense_evasion:process_hollowing"  # Hide malicious process
          - "discovery:network_scanning"  # Scan network
          - "lateral_movement:psexec"  # Move laterally
          - "impact:ransomware"  # Deploy ransomware
    
    sensitivity:  # Detection sensitivity settings
      strict: 0.9  # Require 90% match for chain detection
      moderate: 0.7  # Require 70% match (allow some variations)
      lenient: 0.5  # Require 50% match (detect partial chains)
  
  # Predictive analysis for forecasting next attack steps
  predictive:
    markov_chain:  # Markov chain for predicting attack progression
      enabled: true
      order: 2  # 2nd order Markov chain (considers last 2 states)
      smoothing: "add_one"  # Smoothing technique: "add_one", "good_turing", "kneser_ney"
    
    ml_prediction:  # Machine learning-based prediction
      enabled: true
      models:
        lstm:  # Long Short-Term Memory network
          enabled: true
          sequence_length: 10  # Input sequence length
          lstm_units: 128  # Number of LSTM units
          dropout: 0.2  # Dropout for regularization
        
        transformer:  # Transformer model (attention-based)
          enabled: false  # Disabled - requires more data
          n_layers: 4  # Number of transformer layers
          n_heads: 8  # Number of attention heads
          d_model: 256  # Model dimension
      
      confidence_thresholds:  # Prediction confidence levels
        certain: 0.8  # 80%+ confidence = certain prediction
        high: 0.6  # 60%+ confidence = high confidence
        medium: 0.4  # 40%+ confidence = medium confidence
        low: 0.2  # 20%+ confidence = low confidence

# DIGITAL FORENSICS AGENT
digital_forensics:
  metadata:
    agent_id: "forensics_agent_001"
    name: "Digital Forensics Agent"
    description: "Collects, preserves, and analyzes digital evidence"
    version: "1.0.0"
  
  # Evidence collection settings for what and how to collect
  evidence_collection:
    collect:  # Types of evidence to collect
      logs: true  # System and application logs
      network_traffic: true  # Network packet captures
      memory_dumps: false  # DISABLED - requires special permissions
      disk_images: false  # DISABLED - requires special permissions
      registry_changes: false  # Windows registry - Windows only
      process_list: true  # Running processes
      open_connections: true  # Network connections
      user_sessions: true  # Active user sessions
      file_system_changes: true  # File modifications
    
    methods:  # Collection methods
      live_collection:  # Collect volatile data from running system
        enabled: true
        commands:  # Commands to execute for live collection
          - "ps aux"  # List all processes
          - "netstat -tulpn"  # Network statistics
          - "ss -tulpn"  # Socket statistics (modern alternative)
          - "lsof -i"  # List open files (network)
          - "who"  # Logged in users
          - "last"  # Last logged in users
          - "history"  # Command history
        
      file_system:  # Collect files from filesystem
        enabled: true
        directories:  # Directories to examine
          - "/var/log"  # System logs
          - "/etc"  # Configuration files
          - "/tmp"  # Temporary files
          - "/root/.bash_history"  # Root command history
          - "/home/*/.bash_history"  # User command histories
        
        patterns:  # File patterns to collect
          - "*.log"  # Log files
          - "*.conf"  # Configuration files
          - "*.config"  # Configuration files
          - "access_log*"  # Web server access logs
          - "error_log*"  # Web server error logs
          - "auth.log*"  # Authentication logs
          - "secure*"  # Security logs
        
      network:  # Network traffic collection
        enabled: true
        capture_duration: 300  # Capture duration (seconds)
        capture_filter: "port 80 or port 443 or port 22"  # BPF filter
        max_packets: 10000  # Maximum packets to capture
  
  # Chain of custody for evidence integrity and legal defensibility
  chain_of_custody:
    hash_algorithms:  # Hashing algorithms for integrity verification
      - "sha256"  # SHA-256 (current standard)
      - "sha512"  # SHA-512 (stronger)
      - "md5"  # MD5 (legacy support only)
    
    digital_signatures:  # Digital signatures for non-repudiation
      enabled: true
      algorithm: "RSA"  # RSA algorithm
      key_size: 4096  # 4096-bit keys (current standard)
      certificate_authority: "internal_ca"  # Internal CA for signing
    
    timestamping:  # Trusted timestamping for evidence timing
      enabled: true
      service: "rfc3161"  # RFC 3161 timestamp protocol
      servers:  # Public timestamp servers
        - "http://timestamp.digicert.com"  # DigiCert timestamp
        - "http://timestamp.globalsign.com"  # GlobalSign timestamp
    
    audit_trail:  # Complete audit trail of evidence handling
      enabled: true
      format: "json"  # Audit log format
      retention_days: 365  # Keep audit logs for 1 year
  
  # Timeline analysis for correlating events across time
  timeline:
    time_sources:  # Sources of timestamps for correlation
      system_time: true  # System clock time
      ntp_time: true  # Network Time Protocol synchronized time
      log_timestamps: true  # Timestamps from log files
      file_mtimes: true  # File modification times
      registry_timestamps: false  # Windows registry timestamps
    
    time_normalization:  # Normalize timestamps to common format
      enabled: true
      timezone: "UTC"  # Convert all times to UTC
      format: "ISO8601"  # ISO 8601 format: 2024-01-15T10:30:00Z
    
    correlation:  # Event correlation settings
      enabled: true
      window_seconds: 5  # Time window for correlation
      correlation_methods:  # Correlation techniques
        - "temporal_proximity"  # Events close in time
        - "causal_relationship"  # Cause-effect relationships
        - "statistical_correlation"  # Statistical relationships
        - "sequence_matching"  # Pattern matching
  
  # Artifact analysis for specific types of forensic artifacts
  artifacts:
    logs:  # Log file analysis
      syslog:  # System log analysis
        patterns:  # Patterns to search for in syslog
          - "authentication"  # Auth-related entries
          - "authorization"  # Authorization entries
          - "failed login"  # Failed login attempts
          - "sudo"  # Sudo/su commands
          - "ssh"  # SSH connections
      
      apache:  # Apache web server logs
        patterns:
          - "40[0-9]"  # Client errors (400-499)
          - "50[0-9]"  # Server errors (500-599)
          - "POST"  # POST requests (often data submission)
          - "GET"  # GET requests
          - "HEAD"  # HEAD requests
      
      nginx:  # Nginx web server logs
        patterns: []  # Empty - use default patterns
      
      iis:  # IIS web server logs
        patterns: []  # Empty - Windows specific
    
    memory:  # Memory analysis (if enabled)
      volatility_profiles:  # Volatility memory profiles
        - "LinuxUbuntu2004x64"  # Ubuntu 20.04 profile
        - "Windows10x64"  # Windows 10 profile
      
      plugins:  # Volatility plugins to run
        - "pslist"  # Process list
        - "psscan"  # Process scanning
        - "dlllist"  # DLL list
        - "handles"  # Handle information
        - "netscan"  # Network connections
        - "connscan"  # Connection scanning
        - "sockets"  # Socket information
    
    file_system:  # File system analysis
      suspicious_locations:  # Locations often used by attackers
        - "/tmp/"  # Temporary directory
        - "/dev/shm/"  # Shared memory
        - "/var/tmp/"  # Variable temporary
        - "/root/"  # Root home directory
        - "AppData/Local/Temp/"  # Windows temp directory
        
      hidden_files:  # Hidden file detection
        enabled: true
        patterns:
          - ".*"  # Unix hidden files (dot files)
          - "desktop.ini"  # Windows hidden file
          - "Thumbs.db"  # Windows thumbnail cache

# INCIDENT RESPONSE AGENT
incident_response:
  metadata:
    agent_id: "incident_response_001"
    name: "Incident Response Agent"
    description: "Automates incident response workflows and playbook execution"
    version: "1.0.0"
  
  # Incident classification for prioritization and routing
  classification:
    severity:  # Severity levels with criteria and SLAs
      critical:  # Critical severity incidents
        criteria: "threat_level > 0.8 AND impact = 'high'"  # Classification logic
        sla_minutes: 15  # Response time Service Level Agreement
        escalation_level: "executive"  # Who gets notified
        
      high:  # High severity incidents
        criteria: "threat_level > 0.6 AND impact = 'medium'"
        sla_minutes: 60  # 1 hour response time
        escalation_level: "management"  # Management notification
        
      medium:  # Medium severity incidents
        criteria: "threat_level > 0.4"  # Only threat level threshold
        sla_minutes: 240  # 4 hours response time
        escalation_level: "team_lead"  # Team lead notification
        
      low:  # Low severity incidents
        criteria: "threat_level <= 0.4"  # Low threat level
        sla_minutes: 480  # 8 hours response time
        escalation_level: "analyst"  # Security analyst handles
    
    impact:  # Business impact assessment
      high:  # High impact criteria
        criteria:  # Conditions for high impact
          - "data_breach = true"  # Confirmed data breach
          - "service_outage = true"  # Service disruption
          - "financial_loss > 10000"  >10k financial loss
          - "reputation_damage = true"  # Brand/reputation damage
        
      medium:  # Medium impact criteria
        criteria:
          - "partial_outage = true"  # Partial service disruption
          - "financial_loss > 1000"  >1k financial loss
          - "data_exposure = true"  # Data exposure risk
        
      low:  # Low impact criteria
        criteria:
          - "minor_disruption = true"  # Minor issues
          - "financial_loss <= 1000"  Minimal financial impact
    
    categories:  # Incident categories for classification
      - "malware"  # Malicious software
      - "phishing"  # Phishing attacks
      - "denial_of_service"  # DoS/DDoS attacks
      - "data_breach"  # Data breaches
      - "insider_threat"  # Internal threats
      - "advanced_persistent_threat"  # APTs
      - "ransomware"  # Ransomware attacks
      - "credential_stuffing"  # Credential attacks
      - "web_application_attack"  # Web app attacks
      - "api_abuse"  # API abuse/misuse
  
  # Response playbooks for automated incident handling
  playbooks:
    data_breach:  # Data breach response playbook
      steps:  # Sequential response steps
        - name: "contain_breach"  # Step 1: Containment
          action: "isolate_affected_systems"  # Action to take
          parameters:  # Action parameters
            isolation_method: "network_segmentation"  # How to isolate
          
        - name: "preserve_evidence"  # Step 2: Evidence preservation
          action: "collect_forensic_data"
          parameters:
            collect_logs: true  # Collect log files
            collect_memory: false  # Don't collect memory (permissions)
          
        - name: "assess_impact"  # Step 3: Impact assessment
          action: "identify_affected_data"
          parameters:
            data_types: ["pii", "phi", "financial"]  # Data types to check
          
        - name: "notify_stakeholders"  # Step 4: Notification
          action: "send_notifications"
          parameters:
            recipients: ["legal", "privacy_officer", "executive_team"]  # Who to notify
            template: "data_breach_notification"  # Notification template
          
        - name: "remediate"  # Step 5: Remediation
          action: "apply_remediation"
          parameters:
            actions: ["reset_passwords", "revoke_tokens", "patch_vulnerabilities"]  # Remediation steps
          
        - name: "post_mortem"  # Step 6: Post-incident review
          action: "conduct_post_mortem"
          parameters:
            timeline_days: 30  # Review last 30 days
    
    ransomware:  # Ransomware response playbook
      steps:
        - name: "isolate_infected_systems"
          action: "disconnect_from_network"  # Immediate network isolation
          
        - name: "identify_ransomware_family"
          action: "analyze_malware_samples"  # Identify ransomware variant
          
        - name: "check_for_decryptors"
          action: "query_threat_intelligence"  # Check for available decryptors
          
        - name: "restore_from_backup"
          action: "initiate_disaster_recovery"  # Restore from clean backups
          
        - name: "report_to_authorities"
          action: "contact_law_enforcement"  # Report to law enforcement
    
    ddos:  # DDoS response playbook
      steps:
        - name: "activate_ddos_protection"
          action: "enable_mitigation"  # Enable DDoS protection
          
        - name: "identify_attack_vector"
          action: "analyze_traffic_patterns"  # Analyze attack patterns
          
        - name: "engage_isps"
          action: "contact_upstream_providers"  # Work with ISPs
          
        - name: "monitor_attack"
          action: "track_attack_metrics"  # Monitor attack metrics
          
        - name: "post_attack_analysis"
          action: "generate_attack_report"  # Post-attack analysis
  
  # Automation rules for automatic response actions
  automation:
    auto_containment:  # Automatic containment rules
      enabled: true
      rules:  # Conditions and actions
        - condition: "malware_detected AND confidence > 0.8"  # High confidence malware
          action: "quarantine_host"  # Quarantine infected host
          
        - condition: "brute_force_detected AND attempts > 10"  # Brute force attack
          action: "block_ip"  # Block attacking IP
          
        - condition: "data_exfiltration_detected"  # Data theft detected
          action: "block_outbound_traffic"  # Block data exfiltration
          
        - condition: "ransomware_encryption_detected"  # Ransomware activity
          action: "isolate_network_segment"  # Isolate network segment
    
    auto_remediation:  # Automatic remediation rules
      enabled: true
      rules:
        - condition: "vulnerability_detected AND patch_available"  # Patchable vulnerability
          action: "apply_patch"  # Apply security patch
          
        - condition: "misconfiguration_detected"  # Security misconfiguration
          action: "apply_configuration"  # Apply correct configuration
          
        - condition: "exposed_credentials_detected"  # Exposed credentials
          action: "rotate_credentials"  # Rotate/change credentials
          
        - condition: "malicious_file_detected"  # Malicious file found
          action: "delete_file"  # Remove malicious file
    
    escalation:  # Automatic escalation rules
      enabled: true
      rules:
        - condition: "incident_open_hours > 4"  # Open for 4+ hours
          escalate_to: "team_lead"  # Escalate to team lead
          
        - condition: "incident_open_hours > 8"  # Open for 8+ hours
          escalate_to: "management"  # Escalate to management
          
        - condition: "incident_open_hours > 24"  # Open for 24+ hours
          escalate_to: "executive"  # Escalate to executives
          
        - condition: "data_breach_confirmed"  # Confirmed data breach
          escalate_to: "legal_department"  # Escalate to legal
  
  # Communication templates for incident notifications
  communication:
    email_templates:  # Email notification templates
      incident_alert:  # Initial incident alert
        subject: "Security Incident Alert - {incident_id}"  # Template with variables
        body: |  # Multi-line email body
          A security incident has been detected.
          
          Incident ID: {incident_id}
          Severity: {severity}
          Category: {category}
          Description: {description}
          Detection Time: {detection_time}
          
          Please review the incident in the CyberGuard dashboard.
          
          This is an automated notification from CyberGuard.
      
      escalation_notice:  # Escalation notification
        subject: "Incident Escalation - {incident_id}"
        body: |
          Incident {incident_id} has been escalated due to {reason}.
          
          Current Status: {status}
          Time Open: {time_open}
          Assigned To: {assigned_to}
          
          Action Required: {required_action}
      
      resolution_notice:  # Resolution notification
        subject: "Incident Resolved - {incident_id}"
        body: |
          Incident {incident_id} has been resolved.
          
          Resolution: {resolution}
          Resolution Time: {resolution_time}
          Time to Resolve: {time_to_resolve}
          
          Root Cause: {root_cause}
          Lessons Learned: {lessons_learned}
    
    chat_templates:  # Chat platform templates (Slack/Teams)
      incident_alert:  # Slack/Teams alert
        channel: "#security-alerts"  # Channel to post in
        message: " New Incident: {incident_id} | Severity: {severity} | Category: {category}"
        color: "danger"  # Red color for alerts
        
      status_update:  # Status update
        channel: "#security-incidents"
        message: " Incident Update: {incident_id} | Status: {status} | Progress: {progress}%"
        color: "warning"  # Yellow/orange color
        
      resolution:  # Resolution notification
        channel: "#security-incidents"
        message: " Incident Resolved: {incident_id} | Time to Resolve: {time_to_resolve}"
        color: "good"  # Green color

# COMPLIANCE & PRIVACY AGENT
compliance_privacy:
  metadata:
    agent_id: "compliance_agent_001"
    name: "Compliance & Privacy Agent"
    description: "Ensures compliance with regulatory frameworks and privacy laws"
    version: "1.0.0"
  
  # Regulatory frameworks supported by the agent
  frameworks:
    GDPR:  # General Data Protection Regulation (European Union)
      enabled: true
      version: "2018"  # GDPR enforcement started 2018
      
      requirements:  # Key GDPR requirements to check
        data_protection_officer: true  # DPO appointment required
        data_protection_impact_assessments: true  # DPIAs for high-risk processing
        data_breach_notification: true  # Breach notification within 72 hours
        right_to_access: true  # Individuals can access their data
        right_to_be_forgotten: true  # Right to erasure
        data_portability: true  # Right to data portability
        privacy_by_design: true  # Privacy built into systems
        privacy_by_default: true  # Privacy as default setting
      
      notification_timelines:  # GDPR notification deadlines
        data_breach_notification_hours: 72  # 72-hour breach notification
        data_subject_request_days: 30  # 30 days to respond to requests
      
      penalties:  # GDPR fines and penalties
        tier_1_percent: 2  # 2% of global annual turnover
        tier_2_percent: 4  # 4% of global annual turnover
        tier_1_max: 10000000  # €10 million maximum
        tier_2_max: 20000000  # €20 million maximum
    
    HIPAA:  # Health Insurance Portability and Accountability Act (US)
      enabled: true
      version: "1996"  # Original HIPAA legislation year
      
      phi_identifiers:  # Protected Health Information identifiers
        - "name"  # Individual names
        - "address"  # Geographic identifiers
        - "dates"  # Dates related to individuals
        - "phone_number"  # Telephone numbers
        - "fax_number"  # Fax numbers
        - "email"  # Email addresses
        - "ssn"  # Social Security Numbers
        - "medical_record_number"  # Medical record numbers
        - "health_plan_beneficiary_number"  # Health plan numbers
        - "account_number"  # Account numbers
        - "certificate_license_number"  # Certificate/license numbers
        - "vehicle_identifiers"  # Vehicle identifiers
        - "device_identifiers"  # Device identifiers/serial numbers
        - "url"  # URLs
        - "ip_address"  # IP addresses
        - "biometric_identifiers"  # Fingerprints, retinal scans
        - "full_face_photos"  # Full face photographs
        - "any_other_unique_identifying_number"  # Catch-all
      
      security_rules:  # HIPAA Security Rule categories
        administrative_safeguards: true  # Policies and procedures
        physical_safeguards: true  # Physical access controls
        technical_safeguards: true  # Technical security measures
        
      breach_notification:  # HIPAA breach notification requirements
        individuals: true  # Notify affected individuals
        media: true  # Notify media for breaches > 500 individuals
        secretary: true  # Notify HHS Secretary
        timeline_days: 60  # 60-day notification deadline
    
    PCI_DSS:  # Payment Card Industry Data Security Standard
      enabled: true
      version: "4.0"  # Current PCI DSS version
      
      requirements:  # PCI DSS requirements
        build_and_maintain_secure_network: true  # Requirement 1
        protect_cardholder_data: true  # Requirement 3
        maintain_vulnerability_management: true  # Requirement 5
        implement_strong_access_control: true  # Requirement 7
        regularly_monitor_and_test_networks: true  # Requirement 10
        maintain_information_security_policy: true  # Requirement 12
      
      cde:  # Cardholder Data Environment settings
        network_segmentation: true  # CDE separated from other networks
        scope_reduction: true  # Minimize CDE scope
        access_controls: true  # Strict access controls
        
      validation:  # Compliance validation requirements
        saq_type: "D"  # Self-Assessment Questionnaire type (A, B, C-VT, D)
        qsa_required: true  # Qualified Security Assessor required
        asv_scan_required: true  # Approved Scanning Vendor scans required
    
    CCPA:  # California Consumer Privacy Act
      enabled: true
      version: "2020"  # CCPA effective date
      
      consumer_rights:  # CCPA consumer rights
        right_to_know: true  # Know what data is collected
        right_to_delete: true  # Request data deletion
        right_to_opt_out: true  # Opt out of data sales
        right_to_non_discrimination: true  # No discrimination for exercising rights
        right_to_correct: true  # Correct inaccurate data
        right_to_limit: true  # Limit use of sensitive data
      
      thresholds:  # CCPA applicability thresholds
        annual_revenue: 25000000  # $25 million annual revenue
        data_subjects: 50000  # 50,000+ consumers/households/devices
        revenue_from_data_sales_percent: 50  # 50%+ revenue from data sales
  
  # Privacy controls for data protection
  privacy_controls:
    data_minimization:  # Collect only necessary data
      enabled: true
      collection_limitation: true  # Limit data collection
      purpose_specification: true  # Specify collection purpose
      use_limitation: true  # Limit use to specified purpose
    
    consent:  # Consent management
      enabled: true
      explicit_consent: true  # Require explicit opt-in
      consent_records: true  # Record consent decisions
      consent_withdrawal: true  # Allow consent withdrawal
      age_verification: true  # Verify user age for consent
      
      cookies:  # Cookie consent categories
        essential: true  # Essential cookies (always allowed)
        functional: true  # Functional cookies
        analytics: true  # Analytics cookies
        marketing: true  # Marketing cookies
        third_party: true  # Third-party cookies
    
    data_subject_rights:  # Individual rights management
      access_portal: true  # Self-service data access portal
      automated_processing: true  # Handle automated decision making
      objection_right: true  # Right to object to processing
      rectification_right: true  # Right to correct data
      erasure_right: true  # Right to be forgotten
      restriction_right: true  # Right to restrict processing
      data_portability: true  # Right to data portability
    
    privacy_by_design:  # Privacy engineering principles
      default_privacy: true  # Privacy as default setting
      embedded_privacy: true  # Privacy embedded in design
      full_functionality: true  # Full system functionality
      end_to_end_security: true  # Complete security lifecycle
      visibility_and_transparency: true  # Transparent processing
      respect_for_user_privacy: true  # User-centric design
  
  # Compliance monitoring and reporting
  monitoring:
    continuous:  # Continuous compliance monitoring
      enabled: true
      check_interval: 3600  # Check compliance every hour (seconds)
      
      monitor:  # What to monitor continuously
        data_flows: true  # Data flow mappings
        access_controls: true  # Access control effectiveness
        encryption_status: true  # Encryption implementation
        logging_completeness: true  # Complete audit logging
        retention_policies: true  # Data retention compliance
        third_party_compliance: true  # Vendor compliance
    
    audit_logs:  # Audit logging requirements
      enabled: true
      retention_days: 365  # Keep logs for 1 year minimum
      immutable_logs: true  # Prevent log tampering
      tamper_evident: true  # Detect tampering attempts
      
      audit_events:  # Events that must be audited
        - "data_access"  # Who accessed what data
        - "configuration_changes"  # System configuration changes
        - "user_management"  # User account changes
        - "privilege_escalation"  # Privilege changes
        - "data_export"  # Data export activities
        - "consent_changes"  # Consent status changes
        - "breach_notifications"  # Breach notifications sent
    
    reporting:  # Compliance reporting
      enabled: true
      reports:  # Regular compliance reports
        - name: "compliance_status"  # Monthly compliance status
          frequency: "monthly"  # Generate monthly
          recipients: ["compliance_officer", "legal_department"]  # Who receives it
          
        - name: "privacy_impact_assessment"  # Privacy impact assessment
          frequency: "quarterly"  # Generate quarterly
          recipients: ["data_protection_officer"]  # DPO receives
          
        - name: "data_breach_report"  # Data breach reporting
          frequency: "as_needed"  # Generate when breaches occur
          recipients: ["executive_team", "legal_department"]  # Executives and legal
      
      regulatory_reports:  # Reports for regulators
        gdpr:  # GDPR-specific reports
          data_protection_impact_assessment: true  # DPIAs
          record_of_processing_activities: true  # ROPA
          
        hipaa:  # HIPAA-specific reports
          security_risk_assessment: true  # Security risk assessment
          breach_notification_log: true  # Breach notification log
          
        pci_dss:  # PCI DSS reports
          compliance_report: true  # Annual compliance report
          attestation_of_compliance: true  # AOC document

# SECURE CODE REVIEW AGENT
secure_code_review:
  metadata:
    agent_id: "code_review_001"
    name: "Secure Code Review Agent"
    description: "Static code analysis for security vulnerabilities"
    version: "1.0.0"
  
  # Programming languages supported for analysis
  languages:
    python:  # Python language support
      enabled: true
      versions: ["3.8", "3.9", "3.10", "3.11"]  # Supported Python versions
      analyzers: ["bandit", "safety", "pylint", "mypy"]  # Analysis tools
      config_file: ".bandit.yml"  # Configuration file for bandit
      
    javascript:  # JavaScript language support
      enabled: true
      versions: ["ES6", "ES2020", "ES2022"]  # ECMAScript versions
      analyzers: ["eslint", "njsscan", "snyk"]  # JS analysis tools
      config_file: ".eslintrc.js"  # ESLint configuration
      
    typescript:  # TypeScript language support
      enabled: true
      versions: ["4.0", "4.5", "4.9"]  # TypeScript versions
      analyzers: ["tslint", "typescript-eslint"]  # TS analysis tools
      config_file: "tslint.json"  # TSLint configuration
      
    java:  # Java language support
      enabled: true
      versions: ["8", "11", "17"]  # Java versions
      analyzers: ["spotbugs", "findsecbugs", "checkstyle"]  # Java analysis tools
      config_file: "findbugs.xml"  # FindBugs configuration
      
    go:  # Go language support
      enabled: true
      versions: ["1.19", "1.20"]  # Go versions
      analyzers: ["gosec", "staticcheck"]  # Go analysis tools
      config_file: ".gosec.json"  # Gosec configuration
      
    php:  # PHP language support
      enabled: true
      versions: ["7.4", "8.0", "8.1"]  # PHP versions
      analyzers: ["phpcs", "phpmd", "phpstan"]  # PHP analysis tools
      config_file: "phpcs.xml"  # PHP_CodeSniffer configuration
      
    csharp:  # C# language support
      enabled: true
      versions: ["7.0", "8.0", "9.0"]  # C# versions
      analyzers: ["securitycode scan", "roslyn"]  # C# analysis tools
      config_file: ".editorconfig"  # Editor configuration
      
    ruby:  # Ruby language support
      enabled: true
      versions: ["2.7", "3.0", "3.1"]  # Ruby versions
      analyzers: ["brakeman", "rubocop"]  # Ruby analysis tools
      config_file: ".rubocop.yml"  # RuboCop configuration
  
  # Vulnerability patterns for static analysis
  vulnerability_patterns:
    injection:  # Injection vulnerability patterns
      sql_injection:  # SQL injection patterns
        patterns:  # Code patterns indicating SQL injection risk
          - "execute\\(.*%s"  # Python string formatting in SQL
          - "query\\(.*\\+"  # String concatenation in queries
          - "format\\(.*%s"  # String formatting
          - "f\"SELECT.*{.*}"  # f-strings in SQL
          - "`SELECT.*\\${.*}`"  # Template literals in JS
        severity: "CRITICAL"  # Highest severity level
        
      command_injection:  # Command injection patterns
        patterns:
          - "os.system"  # Python os.system
          - "subprocess.call"  # Python subprocess
          - "subprocess.Popen"  # Python Popen
          - "exec\\("  # Various exec functions
          - "eval\\("  # eval functions
        severity: "CRITICAL"
        
      xss:  # Cross-site scripting patterns
        patterns:
          - "response.write\\(.*request"  # Direct output of request data
          - "echo.*\\$_GET"  # PHP direct output
          - "print.*request"  # Direct request printing
          - "innerHTML.*=.*location"  # DOM XSS patterns
        severity: "HIGH"
    
    auth:  # Authentication and authorization patterns
      hardcoded_credentials:  # Hardcoded passwords/keys
        patterns:
          - "password\\s*=\\s*['\"].*['\"]"  # Password assignment
          - "api_key\\s*=\\s*['\"].*['\"]"  # API key assignment
          - "secret\\s*=\\s*['\"].*['\"]"  # Secret assignment
          - "token\\s*=\\s*['\"].*['\"]"  # Token assignment
        severity: "CRITICAL"
        
      weak_crypto:  # Weak cryptography usage
        patterns:
          - "md5\\("  # MD5 hash function
          - "sha1\\("  # SHA-1 hash function
          - "DES\\."  # DES encryption
          - "RC4"  # RC4 stream cipher
          - "base64\\("  # Base64 encoding (not encryption)
        severity: "HIGH"
        
      missing_authentication:  # Missing authentication checks
        patterns:
          - "@app.route.*methods=.*POST.*\\ndef.*\\n\\s*(?!@auth)"  # Flask routes without auth
          - "public.*void.*Post"  # Java endpoints without auth
          - "function.*post.*\\s*\\{[^}]*\\}(?!.*auth)"  # JS functions without auth
        severity: "HIGH"
    
    data_exposure:  # Data exposure patterns
      sensitive_data_logging:  # Logging sensitive information
        patterns:
          - "logger.*password"  # Logging passwords
          - "console.log.*token"  # Console logging tokens
          - "log.*credit_card"  # Logging credit cards
          - "debug.*ssn"  # Debugging SSNs
        severity: "MEDIUM"
        
      information_disclosure:  # Information disclosure
        patterns:
          - "stack_trace.*print"  # Printing stack traces
          - "error.*details.*response"  # Detailed errors in responses
          - "exception.*message.*send"  # Exception messages sent to users
        severity: "MEDIUM"
    
    configuration:  # Configuration issues
      debug_mode_enabled:  # Debug mode in production
        patterns:
          - "DEBUG\\s*=\\s*True"  # Python DEBUG=True
          - "debug.*true"  # Various debug settings
          - "development.*mode"  # Development mode enabled
        severity: "MEDIUM"
        
      insecure_headers:  # Insecure HTTP headers
        patterns:
          - "Access-Control-Allow-Origin.*\\*"  # CORS wildcard
          - "X-Frame-Options.*none"  # No frame protection
          - "Strict-Transport-Security.*max-age=0"  # Disabled HSTS
        severity: "MEDIUM"
  
  # Analysis settings for code review
  analysis:
    depth: "deep"  # Analysis depth: "quick", "standard", "deep"
    timeout_per_file: 30  # Maximum time to analyze a file (seconds)
    max_file_size: 1048576  # Maximum file size to analyze (1MB)
    
    ignore_patterns:  # Files/directories to ignore
      - "*/node_modules/*"  # Node.js dependencies
      - "*/venv/*"  # Python virtual environments
      - "*/env/*"  # Environment directories
      - "*/dist/*"  # Distribution/build directories
      - "*/build/*"  # Build directories
      - "*/coverage/*"  # Test coverage directories
      - "*.min.js"  # Minified JavaScript
      - "*.min.css"  # Minified CSS
    
    custom_rules:  # Custom analysis rules
      enabled: true
      rules_directory: "config/code_review_rules/"  # Directory for custom rules
      auto_reload: true  # Reload rules automatically
  
  # CI/CD integration for automated security scanning
  cicd:
    pre_commit:  # Pre-commit hooks
      enabled: true
      hook_types:  # Git hook types to install
        - "pre-commit"  # Before commit
        - "pre-push"  # Before push
        - "commit-msg"  # Commit message validation
      
      staged_files_only: true  # Only check staged files
      minimum_severity: "MEDIUM"  # Minimum severity to block commit
    
    pull_requests:  # Pull request analysis
      enabled: true
      platforms:  # Version control platforms
        github:  # GitHub integration
          enabled: true
          app_id: "${GITHUB_APP_ID}"  # GitHub App ID (env var)
          private_key: "${GITHUB_PRIVATE_KEY_PATH}"  # Private key path
          
        gitlab:  # GitLab integration
          enabled: false
          token: "${GITLAB_TOKEN}"  # GitLab token (env var)
          
        bitbucket:  # Bitbucket integration
          enabled: false
          username: "${BITBUCKET_USERNAME}"  # Bitbucket username
          app_password: "${BITBUCKET_APP_PASSWORD}"  # App password
      
      analysis:  # PR analysis settings
        changed_files_only: true  # Only analyze changed files
        new_code_only: true  # Focus on new code
        comment_on_pr: true  # Post comments on PR
        fail_on_critical: true  # Fail PR on critical findings
        threshold: "MEDIUM"  # Minimum severity to comment
    
    pipeline:  # CI/CD pipeline integration
      enabled: true
      stages:  # Pipeline stages for security scanning
        - name: "security_scan"  # Security scanning stage
          position: "after_test"  # Run after tests
          fail_on: "CRITICAL"  # Fail on critical findings
          
        - name: "dependency_check"  # Dependency checking
          position: "after_build"  # Run after build
          fail_on: "HIGH"  # Fail on high severity
          
        - name: "container_scan"  # Container image scanning
          position: "before_deploy"  # Run before deployment
          fail_on: "CRITICAL"  # Fail on critical findings

# THREAT EDUCATION AGENT
threat_education:
  metadata:
    agent_id: "threat_education_001"
    name: "Threat Education Agent"
    description: "Provides security education and training to developers"
    version: "1.0.0"
  
  # Learning modules for different security topics
  learning_modules:
    owasp_top_10:  # OWASP Top-10 training module
      enabled: true
      difficulty: "beginner"  # Target skill level
      estimated_time: "2 hours"  # Time to complete
      modules:  # Individual learning modules
        - id: "a01"  # Module ID
          title: "Broken Access Control"  # Module title
          content: "config/education/owasp/a01.md"  # Content file
          exercises: 5  # Number of exercises
          quiz: true  # Includes quiz
          
        - id: "a02"
          title: "Cryptographic Failures"
          content: "config/education/owasp/a02.md"
          exercises: 4
          quiz: true
          
        - id: "a03"
          title: "Injection"
          content: "config/education/owasp/a03.md"
          exercises: 6
          quiz: true
        
#  Additional OWASP modules would be listed here
    
    secure_coding:  # Secure coding practices
      enabled: true
      difficulty: "intermediate"
      estimated_time: "4 hours"
      languages:  # Programming languages covered
        - "python"
        - "javascript"
        - "java"
        - "go"
      
      topics:  # Secure coding topics
        - "input_validation"  # Validate all inputs
        - "output_encoding"  # Encode outputs properly
        - "authentication"  # Secure authentication
        - "session_management"  # Session security
        - "cryptography"  # Proper crypto usage
        - "error_handling"  # Secure error handling
        - "logging"  # Secure logging practices
    
    incident_response:  # Incident response training
      enabled: true
      difficulty: "advanced"
      estimated_time: "3 hours"
      scenarios:  # Training scenarios
        - "data_breach"  # Data breach scenario
        - "ransomware"  # Ransomware attack
        - "ddos"  # DDoS attack
        - "insider_threat"  # Insider threat
        - "supply_chain_attack"  # Supply chain compromise
      
      roles:  # Incident response roles to train
        - "first_responder"  # Initial response
        - "incident_commander"  # Incident leadership
        - "communications_officer"  # Communication handling
        - "technical_lead"  # Technical leadership
    
    threat_hunting:  # Proactive threat hunting
      enabled: true
      difficulty: "expert"
      estimated_time: "5 hours"
      techniques:  # Threat hunting techniques
        - "hypothesis_driven"  # Hypothesis-based hunting
        - "indicator_based"  # IOC-based hunting
        - "anomaly_based"  # Anomaly detection
        - "machine_learning"  # ML-assisted hunting
      
      tools:  # Threat hunting tools
        - "siem"  # Security Information and Event Management
        - "edr"  # Endpoint Detection and Response
        - "network_monitoring"  # Network traffic analysis
        - "memory_analysis"  # Memory forensics
  
  # Interactive learning environments
  interactive:
    code_labs:  # Hands-on coding labs
      enabled: true
      environment: "docker"  # Containerized lab environment
      image: "cyberguard/codelab:latest"  # Lab container image
      timeout: 1800  # Lab timeout (seconds, 30 minutes)
      
      labs:  # Available labs
        - name: "sql_injection_lab"
          title: "SQL Injection Exploitation and Prevention"
          description: "Learn how SQL injection works and how to prevent it"
          difficulty: "beginner"
          estimated_time: "30 minutes"
          
        - name: "xss_lab"
          title: "Cross-Site Scripting (XSS)"
          description: "Understand XSS attacks and defense mechanisms"
          difficulty: "intermediate"
          estimated_time: "45 minutes"
          
        - name: "csrf_lab"
          title: "Cross-Site Request Forgery"
          description: "Learn CSRF attacks and token-based protection"
          difficulty: "intermediate"
          estimated_time: "40 minutes"
    
    ctf:  # Capture The Flag challenges
      enabled: true
      difficulty_levels:  # CTF difficulty levels
        - "easy"  # Beginner challenges
        - "medium"  # Intermediate challenges
        - "hard"  # Advanced challenges
        - "expert"  # Expert-level challenges
      
      categories:  # CTF challenge categories
        - "web"  # Web security challenges
        - "crypto"  # Cryptography challenges
        - "forensics"  # Digital forensics
        - "reverse_engineering"  # RE challenges
        - "pwn"  # Binary exploitation
      
      platform:  # CTF platform integration
        type: "internal"  # Options: "internal", "ctfd", "root-me"
        url: "http://ctf.cyberguard.local"  # CTF platform URL
        api_key: "${CTF_API_KEY}"  # API key for integration
    
    gamification:  # Gamification elements
      enabled: true
      points_system:  # Points for different achievements
        complete_module: 100  # Points for completing module
        pass_quiz: 50  # Points for passing quiz
        complete_exercise: 25  # Points for exercises
        find_vulnerability: 200  # Points for finding vulns
        report_incident: 150  # Points for reporting incidents
      
      badges:  # Achievement badges
        - name: "security_novice"  # First badge
          threshold: 500  # Points required
          icon: "🥉"  # Badge icon/emoji
          
        - name: "security_pro"  # Intermediate badge
          threshold: 2000  # Points required
          icon: "🥈"  # Silver medal
          
        - name: "security_expert"  # Advanced badge
          threshold: 5000  # Points required
          icon: "🥇"  # Gold medal
          
        - name: "threat_hunter"  # Expert badge
          threshold: 10000  # Points required
          icon: "🏆"  # Trophy
      
      leaderboards:  # Competitive leaderboards
        enabled: true
        reset_interval: "monthly"  # Reset frequency
        categories:  # Leaderboard categories
          - "overall"  # Overall points
          - "by_department"  # Department rankings
          - "by_skill_level"  # Skill level rankings
  
  # Assessment and certification system
  assessment:
    knowledge_assessments:  # Knowledge tests
      enabled: true
      frequency: "quarterly"  # Assessment frequency
      passing_score: 70  # Minimum passing score (percentage)
      retake_limit: 3  # Maximum retake attempts
      retake_delay_days: 7  # Days between retakes
      
      assessments:  # Available assessments
        - name: "security_fundamentals"  # Basic security knowledge
          questions: 20  # Number of questions
          time_limit: 30  # Time limit in minutes
          required_for: ["all_developers"]  # Who must take it
          
        - name: "secure_coding"  # Secure coding knowledge
          questions: 25
          time_limit: 45
          required_for: ["senior_developers", "tech_leads"]
          
        - name: "incident_response"  # Incident response knowledge
          questions: 30
          time_limit: 60
          required_for: ["security_team", "devops"]
    
    skills_assessment:  # Practical skills assessment
      enabled: true
      methods:  # Assessment methods
        - "code_review_exercise"  # Code review practice
        - "vulnerability_identification"  # Find vulnerabilities
        - "incident_response_simulation"  # Simulated incidents
        - "threat_modeling_exercise"  # Threat modeling practice
      
      evaluators:  # Who evaluates skills
        - "automated"  # Automated evaluation
        - "peer_review"  # Peer assessment
        - "security_team"  # Security team evaluation
    
    certification:  # Certification programs
      enabled: true
      programs:  # Available certifications
        - name: "cyberguard_developer"  # Basic certification
          level: "foundational"  # Certification level
          validity_months: 12  # How long certification is valid
          renewal_requirements: ["annual_assessment", "continuous_learning"]  # Renewal requirements
          
        - name: "cyberguard_security_champion"  # Intermediate certification
          level: "intermediate"
          validity_months: 18
          renewal_requirements: ["advanced_training", "mentorship_hours"]
          
        - name: "cyberguard_security_expert"  # Advanced certification
          level: "advanced"
          validity_months: 24
          renewal_requirements: ["research_publication", "conference_presentation"]
  
  # Personalized learning paths based on role and skill level
  learning_paths:
    by_role:  # Role-based learning paths
      developer:  # Software developers
        required_modules: ["owasp_top_10", "secure_coding"]  # Must complete
        recommended_modules: ["threat_hunting"]  # Recommended
        target_certification: "cyberguard_developer"  # Target certification
        
      devops:  # DevOps engineers
        required_modules: ["incident_response", "secure_coding"]
        recommended_modules: ["threat_hunting"]
        target_certification: "cyberguard_security_champion"
        
      security_analyst:  # Security analysts
        required_modules: ["threat_hunting", "incident_response"]
        recommended_modules: ["secure_coding"]
        target_certification: "cyberguard_security_expert"
        
      manager:  # Managers
        required_modules: ["owasp_top_10"]
        recommended_modules: ["incident_response"]
        target_certification: "cyberguard_developer"
    
    by_skill_level:  # Skill-level based paths
      beginner:  # Beginners
        modules: ["owasp_top_10"]  # Starting modules
        prerequisites: []  # No prerequisites
        next_level: "intermediate"  # Next level to aim for
        
      intermediate:  # Intermediate learners
        modules: ["secure_coding", "incident_response"]
        prerequisites: ["beginner"]  # Must complete beginner first
        next_level: "advanced"
        
      advanced:  # Advanced learners
        modules: ["threat_hunting"]
        prerequisites: ["intermediate"]
        next_level: "expert"
        
      expert:  # Expert learners
        modules: ["research_methods", "advanced_threats"]
        prerequisites: ["advanced"]
        next_level: "master"
    
    custom:  # Custom learning path creation
      enabled: true
      max_modules: 10  # Maximum modules per path
      min_duration_hours: 2  # Minimum learning time
      max_duration_hours: 40  # Maximum learning time

# AGENT PERFORMANCE METRICS
agent_metrics:
  collection:  # Metrics collection settings
    enabled: true
    interval: 60  # Collect metrics every 60 seconds
    retention_days: 90  # Keep metrics for 90 days
    
    metrics:  # Metrics to collect
      - "response_time"  # Time to respond to requests
      - "accuracy"  # Detection accuracy
      - "precision"  # Precision (true positives / (true + false positives))
      - "recall"  # Recall (true positives / (true positives + false negatives))
      - "f1_score"  # F1 score (harmonic mean of precision and recall)
      - "false_positives"  # False positive count
      - "false_negatives"  # False negative count
      - "confidence_scores"  # Confidence in findings
      - "memory_usage"  # Memory consumption
      - "cpu_usage"  # CPU utilization
      - "processing_time"  # Time to process requests
  
  thresholds:  # Performance thresholds for alerting
    response_time:  # Response time thresholds (milliseconds)
      excellent: 100  # <100ms = excellent
      good: 500  # <500ms = good
      acceptable: 1000  # <1s = acceptable
      poor: 2000  # <2s = poor
      critical: 5000  # >5s = critical
    
    accuracy:  # Accuracy thresholds (0-1)
      excellent: 0.95  # >95% = excellent
      good: 0.85  # >85% = good
      acceptable: 0.70  # >70% = acceptable
      poor: 0.50  # >50% = poor
      critical: 0.30  # <30% = critical
    
    resource_usage:  # Resource usage thresholds
      memory_mb:  # Memory usage in megabytes
        warning: 512  # >512MB = warning
        critical: 1024  # >1GB = critical
        
      cpu_percent:  # CPU usage percentage
        warning: 70  # >70% = warning
        critical: 90  # >90% = critical
        
      disk_mb:  # Disk usage in megabytes
        warning: 1024  # >1GB = warning
        critical: 2048  # >2GB = critical
  
  alerting:  # Alerting based on performance metrics
    enabled: true
    conditions:  # Alert conditions
      - metric: "response_time"
        condition: "> 2000"  # Response time > 2 seconds
        severity: "warning"
        action: "investigate_slowdown"  # Action to take
        
      - metric: "accuracy"
        condition: "< 0.70"  # Accuracy < 70%
        severity: "critical"
        action: "retrain_agent"  # Retrain the agent
        
      - metric: "memory_usage"
        condition: "> 1024"  # Memory > 1GB
        severity: "warning"
        action: "optimize_memory"  # Optimize memory usage
        
      - metric: "false_positives"
        condition: "> 10 PER HOUR"  # >10 false positives per hour
        severity: "warning"
        action: "adjust_thresholds"  # Adjust detection thresholds
  
  optimization:  # Performance optimization settings
    auto_tuning:  # Automatic parameter tuning
      enabled: true
      parameters:  # Parameters to auto-tune
        - "confidence_thresholds"  # Detection confidence
        - "detection_sensitivity"  # Sensitivity settings
        - "cache_size"  # Cache size optimization
        - "batch_size"  # Processing batch size
      
      interval: 86400  # Tune every 24 hours (seconds)
      
      objective: "maximize_f1_score"  # Optimization goal
      constraints:  # Optimization constraints
        - "response_time < 1000"  # Keep response time under 1s
        - "memory_usage < 512"  # Keep memory under 512MB
        - "false_positives < 5"  # Keep false positives under 5
    
    load_balancing:  # Load balancing between agent instances
      enabled: true
      strategy: "round_robin"  # Options: "round_robin", "least_connections", "ip_hash"
      health_check_interval: 30  # Health check frequency (seconds)
      failover: true  # Automatic failover
      backup_agents: 2  # Number of backup agents
    
    resource_management:  # Resource management
      enabled: true
      limits:  # Resource limits
        cpu_percent: 80  # Maximum CPU usage
        memory_mb: 1024  # Maximum memory
        disk_mb: 2048  # Maximum disk usage
        network_mbps: 100  # Maximum network bandwidth
      
      auto_scaling:  # Auto-scaling configuration
        enabled: true
        min_instances: 1  # Minimum agent instances
        max_instances: 10  # Maximum agent instances
        scale_up_threshold: 70  # Scale up at 70% utilization
        scale_down_threshold: 30  # Scale down at 30% utilization
        cooldown_seconds: 300  # Scaling cooldown period

# AGENT COMMUNICATION PROTOCOL
agent_communication:
  protocol:  # Communication protocol settings
    type: "grpc"  # Options: "grpc", "zeromq", "rabbitmq", "redis"
    encoding: "protobuf"  # Message encoding: "protobuf", "json", "msgpack"
    compression: "gzip"  # Compression: "gzip", "lz4", "snappy", "none"
    
    timeouts:  # Communication timeouts (seconds)
      connect: 5  # Connection timeout
      read: 30  # Read timeout
      write: 30  # Write timeout
      heartbeat: 10  # Heartbeat timeout
    
    retry:  # Retry policy for failed communications
      enabled: true
      max_attempts: 3  # Maximum retry attempts
      backoff_factor: 2.0  # Exponential backoff factor
      max_delay: 60  # Maximum delay between retries (seconds)
  
  messages:  # Message format definitions
    analysis_request:  # Request message format
      fields:  # Required fields
        - "request_id"  # Unique request identifier
        - "timestamp"  # Request timestamp
        - "agent_id"  # Requesting agent ID
        - "data_type"  # Type of data being analyzed
        - "data"  # The data to analyze
        - "priority"  # Request priority
        - "deadline"  # Response deadline
        - "metadata"  # Additional metadata
    
    analysis_response:  # Response message format
      fields:
        - "request_id"  # Corresponding request ID
        - "timestamp"  # Response timestamp
        - "agent_id"  # Responding agent ID
        - "findings"  # Analysis findings
        - "confidence"  # Confidence in findings
        - "threat_level"  # Threat severity level
        - "evidence"  # Supporting evidence
        - "recommendations"  # Remediation recommendations
        - "processing_time"  # Time taken to process
    
    coordination:  # Coordination messages
      types:  # Types of coordination messages
        - "state_update"  # Update agent state
        - "vote_request"  # Request vote from agents
        - "vote_response"  # Vote response
        - "consensus_proposal"  # Consensus proposal
        - "consensus_agreement"  # Consensus agreement
        - "task_assignment"  # Task assignment
        - "task_completion"  # Task completion notification
    
    errors:  # Error message types
      types:
        - "timeout"  # Operation timeout
        - "invalid_data"  # Invalid/malformed data
        - "resource_exhausted"  # Out of resources
        - "agent_unavailable"  # Agent not available
        - "protocol_error"  # Protocol violation
        - "authentication_failed"  # Auth failure
  
  security:  # Communication security
    authentication:  # Authentication mechanism
      enabled: true
      method: "mtls"  # Mutual TLS authentication
      certificate_authority: "config/ca.crt"  # CA certificate
      client_certificate: "config/client.crt"  # Client certificate
      client_key: "config/client.key"  # Client private key
    
    encryption:  # Message encryption
      enabled: true
      algorithm: "AES-256-GCM"  # Encryption algorithm
      key_exchange: "ECDHE"  # Key exchange method
      perfect_forward_secrecy: true  # PFS enabled
    
    authorization:  # Authorization and access control
      enabled: true
      policy_file: "config/authorization_policy.json"  # Policy definition
      cache_ttl: 300  # Policy cache TTL (seconds)
    
    audit:  # Communication auditing
      enabled: true
      log_all_messages: false  # Don't log all messages (privacy)
      sensitive_fields: ["data", "findings", "evidence"]  # Fields to redact
      retention_days: 90  # Keep audit logs for 90 days

# AGENT PERSISTENCE & STATE MANAGEMENT
agent_persistence:
  state:  # State persistence settings
    persist:  # What state to persist
      - "agent_configuration"  # Agent configuration
      - "learning_models"  # ML models and weights
      - "detection_rules"  # Detection rules and patterns
      - "performance_metrics"  # Performance metrics
      - "analysis_history"  # Analysis history
      - "coordination_state"  # Multi-agent coordination state
    
    interval: 300  # Persist state every 5 minutes (seconds)
    
    backend: "redis"  # Storage backend
    connection_string: "${REDIS_URL}"  # Redis connection string (env var)
    
    compression: true  # Compress persisted data
    algorithm: "lz4"  # Compression algorithm
    
    encryption: true  # Encrypt persisted data
    key: "${AGENT_PERSISTENCE_KEY}"  # Encryption key (env var)
  
  recovery:  # State recovery settings
    auto_recover: true  # Automatically recover state on startup
    
    methods:  # Recovery methods (in order of preference)
      - "from_persistence_store"  # From primary persistence
      - "from_backup"  # From backup storage
      - "from_peer"  # From peer agent
    
    priority: ["from_peer", "from_persistence_store", "from_backup"]  # Recovery priority
    
    max_recovery_time: 300  # Maximum time to attempt recovery (seconds)
    
    validation:  # State validation
      enabled: true
      checksum_algorithm: "sha256"  # Checksum algorithm for integrity
      validate_on_load: true  # Validate when loading state
      validate_on_save: true  # Validate when saving state
  
  synchronization:  # State synchronization between agents
    peer_sync:  # Peer-to-peer synchronization
      enabled: true
      sync_interval: 60  # Sync every minute (seconds)
      sync_method: "gossip"  # Sync method: "gossip", "raft", "paxos"
      
      conflict_resolution: "last_write_wins"  # How to resolve conflicts
      custom_resolver: "agent_state_resolver.resolve_conflict"  # Custom resolver function
    
    leader_election:  # Leader election for coordination
      enabled: true
      algorithm: "raft"  # Election algorithm
      election_timeout: 150  # Election timeout (milliseconds)
      heartbeat_interval: 50  # Leader heartbeat interval (milliseconds)
    
    consensus:  # Distributed consensus settings
      enabled: true
      required_quorum: 0.5  # 50% of agents required for consensus
      timeout: 5000  # Consensus timeout (milliseconds)
      retry_attempts: 3  # Consensus retry attempts

# AGENT DEPLOYMENT CONFIGURATION
agent_deployment:
  mode: "container"  # Deployment mode: "container", "process", "serverless"
  
  container:  # Container deployment (Docker)
    image: "cyberguard/agent:latest"  # Container image
    runtime: "docker"  # Container runtime
    
    resources:  # Resource limits
      cpu: "1.0"  # 1 CPU core
      memory: "1G"  # 1GB memory
      memory_reservation: "512M"  # Minimum memory reservation
      memory_swap: "2G"  # Swap memory limit
    
    network:  # Networking configuration
      mode: "host"  # Network mode
      ports:  # Port mappings
        - "8080:8080"  # Host:Container port mapping
      
      dns:  # DNS servers
        - "8.8.8.8"  # Google DNS
        - "8.8.4.4"  # Google DNS backup
    
    volumes:  # Volume mounts
      - "/etc/cyberguard:/config:ro"  # Read-only config
      - "/var/log/cyberguard:/logs"  # Log directory
      - "/var/lib/cyberguard:/data"  # Data directory
    
    environment:  # Environment variables
      - "AGENT_ID=${AGENT_ID}"  # Agent ID from env
      - "AGENT_TYPE=${AGENT_TYPE}"  # Agent type from env
      - "LOG_LEVEL=INFO"  # Log level
      - "CONFIG_PATH=/config"  # Configuration path
    
    healthcheck:  # Health check configuration
      test: ["CMD", "python", "-c", "import agent; agent.health_check()"]  # Health check command
      interval: 30s  # Check every 30 seconds
      timeout: 10s  # Timeout after 10 seconds
      retries: 3  # 3 retries before unhealthy
      start_period: 60s  # 60 seconds initial startup period
  
  process:  # Process deployment (traditional)
    supervisor: "systemd"  # Process supervisor
    
    systemd:  # Systemd service configuration
      service_file: "/etc/systemd/system/cyberguard-agent.service"  # Service file
      user: "cyberguard"  # Run as user
      group: "cyberguard"  # Run as group
      working_directory: "/opt/cyberguard"  # Working directory
      environment_file: "/etc/cyberguard/agent.env"  # Environment file
      
      after:  # Service dependencies
        - "network.target"  # After network
        - "redis.service"  # After Redis
        - "postgresql.service"  # After PostgreSQL
      
      requires:  # Required services
        - "redis.service"  # Requires Redis
        - "postgresql.service"  # Requires PostgreSQL
    
    limits:  # Process resource limits
      nofile: 65536  # Maximum open files
      nproc: 4096  # Maximum processes
      memlock: "unlimited"  # Memory locking
      core: "unlimited"  # Core dumps
  
  serverless:  # Serverless deployment (cloud functions)
    platform: "aws_lambda"  # Serverless platform
    
    aws_lambda:  # AWS Lambda configuration
      runtime: "python3.10"  # Python runtime
      handler: "agent.handler.lambda_handler"  # Lambda handler
      memory_size: 1024  # Memory in MB
      timeout: 300  # Timeout in seconds
      concurrency: 100  # Concurrent executions
      
      vpc_config:  # VPC configuration
        subnet_ids:  # Subnets
          - "${AWS_SUBNET_1}"  # From environment
          - "${AWS_SUBNET_2}"  # From environment
        security_group_ids:  # Security groups
          - "${AWS_SECURITY_GROUP}"  # From environment
      
      environment:  # Lambda environment
        variables:
          AGENT_ID: "${AGENT_ID}"  # Agent ID
          CONFIG_BUCKET: "cyberguard-config"  # Config S3 bucket
          LOG_GROUP: "/aws/lambda/cyberguard-agent"  # CloudWatch log group
    
    event_sources:  # Event sources for Lambda
      - type: "api_gateway"  # API Gateway events
        methods: ["POST"]  # HTTP methods
        path: "/analyze"  # API path
        
      - type: "s3"  # S3 events
        bucket: "cyberguard-input"  # S3 bucket
        events: ["s3:ObjectCreated:*"]  # S3 events
        
      - type: "sqs"  # SQS events
        queue: "cyberguard-queue"  # SQS queue
        batch_size: 10  # Batch size for processing
  
  auto_scaling:  # Auto-scaling configuration
    enabled: true
    
    metrics:  # Scaling metrics
      - type: "cpu_utilization"  # CPU-based scaling
        target: 70  # Target CPU utilization (%)
        scale_in_cooldown: 300  # Scale-in cooldown (seconds)
        scale_out_cooldown: 60  # Scale-out cooldown (seconds)
      
      - type: "memory_utilization"  # Memory-based scaling
        target: 80  # Target memory utilization (%)
        scale_in_cooldown: 300
        scale_out_cooldown: 60
      
      - type: "request_count"  # Request-based scaling
        target: 1000  # Target requests per minute
        scale_in_cooldown: 300
        scale_out_cooldown: 60
    
    policies:  # Scaling policies
      - type: "target_tracking"  # Target tracking scaling
        metric: "cpu_utilization"
        target_value: 70  # Target 70% CPU
        
      - type: "step_scaling"  # Step scaling
        adjustments:  # Scaling adjustments
          - metric_interval_lower_bound: 0  # Lower bound
            metric_interval_upper_bound: 10  # Upper bound
            scaling_adjustment: -1  # Remove 1 instance
          
          - metric_interval_lower_bound: 50  # 50-70% CPU
            metric_interval_upper_bound: 70
            scaling_adjustment: 1  # Add 1 instance
          
          - metric_interval_lower_bound: 70  # >70% CPU
            scaling_adjustment: 2  # Add 2 instances
  
  monitoring:  # Monitoring and observability
    logs:  # Log aggregation
      driver: "json-file"  # Log driver
      options:  # Log options
        max-size: "10m"  # Maximum log file size
        max-file: "3"  # Maximum log files
        tag: "cyberguard-agent"  # Log tag
    
    metrics:  # Metrics collection
      endpoint: "0.0.0.0:9090"  # Metrics endpoint
      path: "/metrics"  # Metrics path
      interval: "15s"  # Metrics collection interval
      
      custom_metrics:  # Custom metrics
        - name: "agent_requests_total"  # Total requests
          type: "counter"  # Counter metric type
          help: "Total number of requests processed"  # Metric description
          
        - name: "agent_processing_seconds"  # Processing time
          type: "histogram"  # Histogram metric type
          help: "Time spent processing requests"
          buckets: [0.1, 0.5, 1.0, 2.0, 5.0]  # Histogram buckets (seconds)
    
    tracing:  # Distributed tracing
      enabled: true
      provider: "jaeger"  # Tracing provider
      endpoint: "http://jaeger:14268/api/traces"  # Tracing endpoint
      sampling_rate: 0.1  # Sample 10% of requests